"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[33325],{15868:(e,n,s)=>{s.d(n,{A:()=>r});var i=s(65162),o=s(62540);function r(e){let{header:n,inline:s,updated:r,version:t}=e;return(0,o.jsx)(i.A,{text:`v${t}`,variant:r?"success":"info",className:n?"absolute right-0 top-1.5":s?"inline-block ml-1":"ml-2"})}},43023:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(63696);const o={},r=i.createContext(o);function t(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),i.createElement(r.Provider,{value:n},e.children)}},56851:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>d,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"proto/tool-spec","title":"Tool specification","description":"Since proto is a toolchain for multiple tools, each with differing version formats, we must align","source":"@site/docs/proto/tool-spec.mdx","sourceDirName":"proto","slug":"/proto/tool-spec","permalink":"/docs/proto/tool-spec","draft":false,"unlisted":false,"editUrl":"https://github.com/moonrepo/moon/tree/master/website/docs/proto/tool-spec.mdx","tags":[],"version":"current","frontMatter":{"title":"Tool specification"},"sidebar":"proto","previous":{"title":"Configuration","permalink":"/docs/proto/config"},"next":{"title":"Version detection","permalink":"/docs/proto/detection"}}');var o=s(62540),r=s(43023),t=s(68259),l=s(15868);const d={title:"Tool specification"},a=void 0,c={},h=[{value:"Backends<VersionLabel></VersionLabel>",id:"backends",level:2},{value:"<code>asdf</code>",id:"asdf",level:3},{value:"Semantic versions",id:"semantic-versions",level:2},{value:"Syntax",id:"syntax",level:3},{value:"Guidelines",id:"guidelines",level:3},{value:"Calendar versions<VersionLabel></VersionLabel>",id:"calendar-versions",level:2},{value:"Syntax",id:"syntax-1",level:3},{value:"Guidelines",id:"guidelines-1",level:3},{value:"Requirements and ranges",id:"requirements-and-ranges",level:2},{value:"Syntax",id:"syntax-2",level:3},{value:"Guidelines",id:"guidelines-2",level:3}];function x(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.A,{text:"3 min"}),"\n",(0,o.jsx)(n.p,{children:"Since proto is a toolchain for multiple tools, each with differing version formats, we must align\nthem on a standard specification that can resolve and store safely. To handle this, we've\nimplemented our own solution called the tool and version specification. This specification currently\nsupports semantic and calendar based versions, each with their own guidelines and caveats."}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsx)(n.p,{children:"If you're implementing a plugin for a specific tool that has a different version format, you'll need\nto re-format it into one of the specifications below."})}),"\n",(0,o.jsxs)(n.h2,{id:"backends",children:["Backends",(0,o.jsx)(l.A,{version:"0.47.0"})]}),"\n",(0,o.jsx)(n.p,{children:"A backend is an internal system that allows proto to use plugins from 3rd-party package/version\nmanagers within proto, greatly expanding the amount of tools that proto can install and support.\nThis functionality is achieved through special WASM plugins under the hood."}),"\n",(0,o.jsxs)(n.p,{children:["To make use of a backend, prefix the version in ",(0,o.jsx)(n.code,{children:".prototools"})," with the backend's unique identifier.\nFor example, we can install Zig via asdf."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-toml",metastring:'title=".prototools"',children:'zig = "asdf:0.13.0"\n'})}),"\n",(0,o.jsxs)(n.p,{children:["The approach above only utilizes the backend for that specific version. If you want to utilize the\nbackend for all versions (without using the version prefix), you can use the\n",(0,o.jsx)(n.a,{href:"./config#backend",children:(0,o.jsx)(n.code,{children:"tools.*.backend"})})," setting."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-toml",metastring:'title=".prototools"',children:'zig = "0.13.0"\n\n[tools.zig]\nbackend = "asdf"\n'})}),"\n",(0,o.jsx)(n.h3,{id:"asdf",children:(0,o.jsx)(n.code,{children:"asdf"})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"asdf"})," backend will utilize the ",(0,o.jsx)(n.a,{href:"https://asdf-vm.com/",children:"asdf version manager"})," for downloading and\ninstalling a tool, loading versions, and locating executables. This backend implementation ",(0,o.jsx)(n.em,{children:"does\nnot"})," use the ",(0,o.jsx)(n.code,{children:"asdf"})," binary itself, and instead emulates the environment as best we can. Because of\nthis, some tools may not be usable through proto."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-toml",metastring:'title=".prototools"',children:'<id> = "asdf:20"\n'})}),"\n",(0,o.jsxs)(n.p,{children:["By default, the ID pinned in ",(0,o.jsx)(n.code,{children:".prototools"})," is the\n",(0,o.jsx)(n.a,{href:"https://asdf-vm.com/plugins/create.html#plugin-shortname-index",children:"asdf shortname"})," used when cloning a\nrepository. If the ID is different than the shortname (",(0,o.jsx)(n.code,{children:"node"})," vs ",(0,o.jsx)(n.code,{children:"nodejs"}),"), you can configure the\n",(0,o.jsx)(n.code,{children:"asdf-shortname"})," setting."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-toml",metastring:'title=".prototools"',children:'node = "asdf:20"\n\n[tools.node]\nasdf-shortname = "nodejs"\n'})}),"\n",(0,o.jsx)(n.p,{children:"The following settings are supported:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"asdf-shortname"})," (string) - The name of the ",(0,o.jsx)(n.a,{href:"https://github.com/asdf-vm/asdf-plugins",children:"asdf plugin"}),"\nif different than the configured ID."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"asdf-repository"})," (string) - The Git repository URL in which to locate\n",(0,o.jsx)(n.a,{href:"https://asdf-vm.com/plugins/create.html#scripts-overview",children:"scripts"}),". If not defined, is extracted\nfrom the shortname plugin index."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"exes"})," (string[]) - List of executable file names (relative from ",(0,o.jsx)(n.code,{children:"bin"}),") to be linked as a\nshim/bin. If not defined, we'll automatically scan the ",(0,o.jsx)(n.code,{children:"bin"})," directory."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"semantic-versions",children:"Semantic versions"}),"\n",(0,o.jsxs)(n.p,{children:["The most common format is ",(0,o.jsx)(n.a,{href:"https://semver.org/",children:"semver"}),", also known as a semantic version. This\nformat requires major, minor, and patch numbers, with optional pre-release and build metadata."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-toml",metastring:'title=".prototools"',children:'tool = "1.2.3"\n'})}),"\n",(0,o.jsx)(n.h3,{id:"syntax",children:"Syntax"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"<major>.<minor>.<patch>"})," - 1.2.3"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"<major>.<minor>.<patch>-<pre>"})," - 1.2.3-alpha.0"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"<major>.<minor>.<patch>-<pre>+<build>"})," - 1.2.3-alpha.0+nightly456"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"<major>.<minor>.<patch>+<build>"})," - 1.2.3+nightly456"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"guidelines",children:"Guidelines"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["major, minor, patch - ",(0,o.jsx)(n.code,{children:"0-9"})," of any length"]}),"\n",(0,o.jsxs)(n.li,{children:["pre, build - ",(0,o.jsx)(n.code,{children:"a-z"}),", ",(0,o.jsx)(n.code,{children:"0-9"}),", ",(0,o.jsx)(n.code,{children:"-"}),", ",(0,o.jsx)(n.code,{children:"."})]}),"\n"]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://semver.org/#backusnaur-form-grammar-for-valid-semver-versions",children:"Learn more about this format!"})}),"\n"]}),"\n",(0,o.jsxs)(n.h2,{id:"calendar-versions",children:["Calendar versions",(0,o.jsx)(l.A,{version:"0.37.0"})]}),"\n",(0,o.jsxs)(n.p,{children:["Another popular format is ",(0,o.jsx)(n.a,{href:"https://calver.org/",children:"calver"}),", also known as a calendar version, which\nuses the calendar year, month, and day as version numbers. This format also supports pre-release and\nbuild metadata, but with different syntax than semver."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-toml",metastring:'title=".prototools"',children:'tool = "2025-02-26"\n'})}),"\n",(0,o.jsx)(n.h3,{id:"syntax-1",children:"Syntax"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"<year>-<month>"})," - 2024-02"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"<year>-<month>-<day>"})," - 2024-02-26"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"<year>-<month>-<day>.<build>"})," - 2024-02-26.123"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"<year>-<month>-<day>_<build>"})," - 2024-02-26_123"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"<year>-<month>-<day>.<build>-<pre>"})," - 2024-02-26.123-alpha.0"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"<year>-<month>-<day>_<build>-<pre>"})," - 2024-02-26_123-alpha.0"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"<year>-<month>-<day>-<pre>"})," - 2024-02-26-alpha.0"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"guidelines-1",children:"Guidelines"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["year - ",(0,o.jsx)(n.code,{children:"0-9"})," of 1-4 length","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["If the year is not YYYY format, it will use the year 2000 as the base. For example, ",(0,o.jsx)(n.code,{children:"24"})," becomes\n",(0,o.jsx)(n.code,{children:"2024"}),", and ",(0,o.jsx)(n.code,{children:"124"})," becomes ",(0,o.jsx)(n.code,{children:"2124"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["month - ",(0,o.jsx)(n.code,{children:"0-9"})," of 1-2 length","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Supports with and without a leading zero (",(0,o.jsx)(n.code,{children:"02"})," vs ",(0,o.jsx)(n.code,{children:"2"}),")."]}),"\n",(0,o.jsxs)(n.li,{children:["Does not support invalid months (",(0,o.jsx)(n.code,{children:"0"})," or ",(0,o.jsx)(n.code,{children:"13"}),")."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["day - ",(0,o.jsx)(n.code,{children:"0-9"})," of 1-2 length","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Can be omitted, even with build/pre."}),"\n",(0,o.jsxs)(n.li,{children:["Supports with and without a leading zero (",(0,o.jsx)(n.code,{children:"02"})," vs ",(0,o.jsx)(n.code,{children:"2"}),")."]}),"\n",(0,o.jsxs)(n.li,{children:["Does not support invalid days (",(0,o.jsx)(n.code,{children:"0"})," or ",(0,o.jsx)(n.code,{children:"32"}),")."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["build - ",(0,o.jsx)(n.code,{children:"0-9"})," of any length","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:'Also known as a "micro" number.'}),"\n",(0,o.jsxs)(n.li,{children:["The leading dot ",(0,o.jsx)(n.code,{children:"."})," format is preferred."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["pre - ",(0,o.jsx)(n.code,{children:"a-z"}),", ",(0,o.jsx)(n.code,{children:"0-9"}),", ",(0,o.jsx)(n.code,{children:"-"}),", ",(0,o.jsx)(n.code,{children:"."})]}),"\n"]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://calver.org/#scheme",children:"Learn more about this format!"})}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"requirements-and-ranges",children:"Requirements and ranges"}),"\n",(0,o.jsx)(n.p,{children:"Besides an explicit version, we also support partial versions known as version requirements or\nversion ranges. These are quite complex as we need to support both semver and calver in unison, as\nwell as support partial/incomplete numbers (missing patch/day, missing minor/month, etc). We do our\nbest to support as many combinations as possible."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-toml",metastring:'title=".prototools"',children:'tool-a = "^1"\ntool-b = "~2.1"\ntool-c = ">=2000-10"\n'})}),"\n",(0,o.jsx)(n.h3,{id:"syntax-2",children:"Syntax"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Requirement - ",(0,o.jsx)(n.code,{children:"[<op>]<pattern>"})," - ",(0,o.jsx)(n.code,{children:"1.2.3"}),", ",(0,o.jsx)(n.code,{children:">4.5"}),", ",(0,o.jsx)(n.code,{children:"~3"}),", ",(0,o.jsx)(n.code,{children:"^2000-10"}),", etc"]}),"\n",(0,o.jsxs)(n.li,{children:["AND range - ",(0,o.jsx)(n.code,{children:"<requirement>[,] <requirement> ..."})," - ",(0,o.jsx)(n.code,{children:">=1, <2"}),", ",(0,o.jsx)(n.code,{children:"^1.3 <=1.3.9"}),", etc"]}),"\n",(0,o.jsxs)(n.li,{children:["OR range - ",(0,o.jsx)(n.code,{children:"<requirement> || <requirement> ..."})," - ",(0,o.jsx)(n.code,{children:"^1.2 || ^2.3"}),", ",(0,o.jsx)(n.code,{children:"~2000-10 || ~2010-2"}),", etc"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"guidelines-2",children:"Guidelines"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["op - ",(0,o.jsx)(n.code,{children:"="}),", ",(0,o.jsx)(n.code,{children:">"}),", ",(0,o.jsx)(n.code,{children:">="}),", ",(0,o.jsx)(n.code,{children:"<="}),", ",(0,o.jsx)(n.code,{children:"<"}),", ",(0,o.jsx)(n.code,{children:"~"}),", ",(0,o.jsx)(n.code,{children:"^"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["If omitted, defaults to ",(0,o.jsx)(n.code,{children:"~"})," when not in a range."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["pattern","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Dot-separated semver, with optional major and patch numbers."}),"\n",(0,o.jsx)(n.li,{children:"Dash-separated calver, with optional month and day numbers."}),"\n",(0,o.jsx)(n.li,{children:"Pre-release and build metadata are only supported when suffixed to full versions."}),"\n"]}),"\n"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(x,{...e})}):x(e)}},65162:(e,n,s)=>{s.d(n,{A:()=>l});var i=s(11750),o=s(74599),r=s(62540);const t={failure:"bg-red-100 text-red-900",info:"bg-pink-100 text-pink-900",success:"bg-green-100 text-green-900",warning:"bg-orange-100 text-orange-900"};function l(e){let{className:n,icon:s,text:l,variant:d}=e;return(0,r.jsxs)("span",{className:(0,i.A)("inline-flex items-center px-1 py-0.5 rounded text-xs font-bold uppercase",d?t[d]:"bg-gray-100 text-gray-800",n),children:[s&&(0,r.jsx)(o.A,{icon:s,className:"mr-1"}),l]})}},68259:(e,n,s)=>{s.d(n,{A:()=>r});var i=s(65162),o=s(62540);function r(e){let{text:n}=e;return(0,o.jsx)(i.A,{text:n,icon:"material-symbols:clock-loader-40",variant:"success",className:"absolute right-0 top-1.5"})}}}]);