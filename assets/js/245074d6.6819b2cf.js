"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[64845],{15868:(e,n,o)=>{o.d(n,{A:()=>s});var i=o(65162),r=o(62540);function s(e){let{header:n,inline:o,updated:s,version:t}=e;return(0,r.jsx)(i.A,{text:`v${t}`,variant:s?"success":"info",className:n?"absolute right-0 top-1.5":o?"inline-block ml-1":"ml-2"})}},43023:(e,n,o)=>{o.d(n,{R:()=>t,x:()=>l});var i=o(63696);const r={},s=i.createContext(r);function t(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(s.Provider,{value:n},e.children)}},65162:(e,n,o)=>{o.d(n,{A:()=>l});var i=o(11750),r=o(74599),s=o(62540);const t={failure:"bg-red-100 text-red-900",info:"bg-pink-100 text-pink-900",success:"bg-green-100 text-green-900",warning:"bg-orange-100 text-orange-900"};function l(e){let{className:n,icon:o,text:l,variant:d}=e;return(0,s.jsxs)("span",{className:(0,i.A)("inline-flex items-center px-1 py-0.5 rounded text-xs font-bold uppercase",d?t[d]:"bg-gray-100 text-gray-800",n),children:[o&&(0,s.jsx)(r.A,{icon:o,className:"mr-1"}),l]})}},78838:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>x,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"proto/workflows","title":"Workflows","description":"With proto, we provide multiple workflows for everyday use for you to choose from. They can be used","source":"@site/docs/proto/workflows.mdx","sourceDirName":"proto","slug":"/proto/workflows","permalink":"/docs/proto/workflows","draft":false,"unlisted":false,"editUrl":"https://github.com/moonrepo/moon/tree/master/website/docs/proto/workflows.mdx","tags":[],"version":"current","frontMatter":{"title":"Workflows","toc_max_heading_level":6},"sidebar":"proto","previous":{"title":"Install proto","permalink":"/docs/proto/install"},"next":{"title":"Configuration","permalink":"/docs/proto/config"}}');var r=o(62540),s=o(43023),t=o(15868);const l={title:"Workflows",toc_max_heading_level:6},d=void 0,c={},a=[{value:"Shims",id:"shims",level:2},{value:"Setup",id:"setup",level:3},{value:"Binary linking",id:"binary-linking",level:2},{value:"Setup",id:"setup-1",level:3},{value:"Shell activation<VersionLabel></VersionLabel>",id:"shell-activation",level:2},{value:"Setup",id:"setup-2",level:3},{value:"Comparison",id:"comparison",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"With proto, we provide multiple workflows for everyday use for you to choose from. They can be used\nindividually, or together, it's up to you!"}),"\n",(0,r.jsx)(n.h2,{id:"shims",children:"Shims"}),"\n",(0,r.jsxs)(n.p,{children:["proto is primarily powered by the industry standard concept of shims. For each tool installed in\nproto, a shim file will exist at ",(0,r.jsx)(n.code,{children:"~/.proto/shims"})," for the primary executable, and some secondary\nexecutables. Shims ",(0,r.jsx)(n.em,{children:"are not"})," symlinks to the tool's binary, but are thin wrappers around\n",(0,r.jsx)(n.a,{href:"./commands/run",children:(0,r.jsx)(n.code,{children:"proto run"})}),", enabling ",(0,r.jsx)(n.a,{href:"./detection",children:"runtime version detection"})," on every\ninvocation! For example, these are equivalent:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"$ proto run node -- --version\n20.0.0\n\n$ node --version\n20.0.0\n\n$ which node\n~/.proto/shims/node\n"})}),"\n",(0,r.jsx)(n.h3,{id:"setup",children:"Setup"}),"\n",(0,r.jsxs)(n.p,{children:["To make use of shims, prepend the ",(0,r.jsx)(n.code,{children:"~/.proto/shims"})," directory to ",(0,r.jsx)(n.code,{children:"PATH"})," in your shell profile. This\n",(0,r.jsx)(n.em,{children:"must come before"})," the ",(0,r.jsx)(n.a,{href:"#binary-linking",children:"bin directory"})," if using both."]}),"\n",(0,r.jsxs)(n.p,{children:["If you're using or plan to use ",(0,r.jsx)(n.a,{href:"#shell-activation",children:"shell activation"}),", the ",(0,r.jsx)(n.code,{children:"PATH"})," configuration\nhappens automatically, but shell activation will only work if the ",(0,r.jsx)(n.code,{children:"proto"})," command is accessible,\nwhich requires ",(0,r.jsx)(n.code,{children:"~/.proto/bin"})," to be in your ",(0,r.jsx)(n.code,{children:"PATH"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"binary-linking",children:"Binary linking"}),"\n",(0,r.jsxs)(n.p,{children:["Alternatively, we also support a non-shim based approach, which creates symlinks to a versioned\ntool's primary and secondary executables. For each tool installed in proto, a symlink will exist at\n",(0,r.jsx)(n.code,{children:"~/.proto/bin"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"$ node --version\n23.1.0\n\n$ which node\n~/.proto/bin/node -> ~/.proto/tools/node/23.1.0/bin/node\n"})}),"\n",(0,r.jsx)(n.p,{children:"When a tool is installed into proto, we symlink many binaries based on all the versions that are\ninstalled in the toolchain. The primary binary will always point to the highest installed version,\nwhile we also create binaries for the highest major, and highest major + minor combinations. For\nexample:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"~/.proto/bin/node"})," - Points to the highest version."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"~/.proto/bin/node-<major>"})," - Points to the highest version within that major range (",(0,r.jsx)(n.code,{children:"~major"}),"). Is\ncreated for each separate major version, for example: ",(0,r.jsx)(n.code,{children:"node-20"}),", ",(0,r.jsx)(n.code,{children:"node-22"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"~/.proto/bin/node-<major>.<minor>"})," - Points to the highest version within that major + minor\nrange (",(0,r.jsx)(n.code,{children:"~major.minor"}),"). Is created for each separate major + minor version, for example:\n",(0,r.jsx)(n.code,{children:"node-20.1"}),", ",(0,r.jsx)(n.code,{children:"node-22.4"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"~/.proto/bin/node-canary"})," - Points to a canary install, if it exists."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"$ node-22 --version\n22.5.1\n\n$ which node-22\n~/.proto/bin/node-22 -> ~/.proto/tools/node/22.5.1/bin/node\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:"Not all tools support symlinking a binary, as not all files are executable. For example, most\nNode.js package managers currently do not support this, as JavaScript files are not executable\n(especially on Windows). Shims are required for these tools."})}),"\n",(0,r.jsx)(n.h3,{id:"setup-1",children:"Setup"}),"\n",(0,r.jsxs)(n.p,{children:["To make use of bins, prepend the ",(0,r.jsx)(n.code,{children:"~/.proto/bin"})," directory to ",(0,r.jsx)(n.code,{children:"PATH"})," in your shell profile. This\n",(0,r.jsx)(n.em,{children:"must come after"})," the ",(0,r.jsx)(n.a,{href:"#shims",children:"shim directory"})," if using shims."]}),"\n",(0,r.jsxs)(n.p,{children:["If you're using or plan to use ",(0,r.jsx)(n.a,{href:"#shell-activation",children:"shell activation"}),", the ",(0,r.jsx)(n.code,{children:"PATH"})," configuration\nhappens automatically, but shell activation will only work if the ",(0,r.jsx)(n.code,{children:"proto"})," command is accessible,\nwhich requires ",(0,r.jsx)(n.code,{children:"~/.proto/bin"})," to be in your ",(0,r.jsx)(n.code,{children:"PATH"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["This directory must always exist in ",(0,r.jsx)(n.code,{children:"PATH"}),", as the official proto binaries ",(0,r.jsx)(n.code,{children:"~/.proto/bin/proto"})," and\n",(0,r.jsx)(n.code,{children:"~/.proto/bin/proto-shim"})," are located here. If you move those binaries to another location, you can\nomit ",(0,r.jsx)(n.code,{children:"~/.proto/bin"})," from ",(0,r.jsx)(n.code,{children:"PATH"})," if you like."]})}),"\n",(0,r.jsxs)(n.h2,{id:"shell-activation",children:["Shell activation",(0,r.jsx)(t.A,{version:"0.38.0"})]}),"\n",(0,r.jsx)(n.p,{children:"Our last workflow is what we call shell activation (or shell hooks), and it's where the proto\nenvironment is setup/reset every time you change directories. If you're coming from another version\nmanager, you may be familiar with this kind of workflow."}),"\n",(0,r.jsxs)(n.p,{children:["So how does this work exactly? In your shell profile, you'll evaluate a call to\n",(0,r.jsx)(n.a,{href:"./commands/activate",children:(0,r.jsx)(n.code,{children:"proto activate <shell>"})}),', which generates a bunch of shell specific syntax\nthat registers a hook for "run this code when the current directory or prompt line changes". Once\nthis hook is registered and you run ',(0,r.jsx)(n.code,{children:"cd"})," (for example), proto will..."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Load all ",(0,r.jsx)(n.code,{children:".prototools"})," files"]}),"\n",(0,r.jsxs)(n.li,{children:["Extract tools with a ",(0,r.jsx)(n.a,{href:"./config#pinning-versions",children:"configured version"})]}),"\n",(0,r.jsxs)(n.li,{children:["For each tool:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Load associated WASM plugin"}),"\n",(0,r.jsxs)(n.li,{children:["Export environment variables based on ",(0,r.jsx)(n.a,{href:"./config#env",children:(0,r.jsx)(n.code,{children:"[env]"})})," and\n",(0,r.jsx)(n.a,{href:"./config#toolsenv",children:(0,r.jsx)(n.code,{children:"[tools.*.env]"})})]}),"\n",(0,r.jsxs)(n.li,{children:["Prepend ",(0,r.jsx)(n.code,{children:"PATH"})," with tool-specific directories (like local and global executables) for the\ndetected version"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"$ cd /some/path && node --version\n20.0.0\n\n$ cd /another/path && node --version\n18.0.0\n"})}),"\n",(0,r.jsx)(n.h3,{id:"setup-2",children:"Setup"}),"\n",(0,r.jsxs)(n.p,{children:["View the ",(0,r.jsx)(n.a,{href:"./commands/activate#setup",children:(0,r.jsx)(n.code,{children:"proto activate"})})," documentation for information on how to setup\nyour shell profile for this workflow."]}),"\n",(0,r.jsx)(n.h2,{id:"comparison",children:"Comparison"}),"\n",(0,r.jsx)(n.p,{children:"The workflows above may come across as information overload, so we've provided the following\ncomparison table outlining the features each workflow supports."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Shims"}),(0,r.jsx)(n.th,{children:"Bins"}),(0,r.jsx)(n.th,{children:"Activate"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Runtime version detection"}),(0,r.jsx)(n.td,{children:"\ud83d\udfe2"}),(0,r.jsx)(n.td,{children:"\ud83d\udd34"}),(0,r.jsx)(n.td,{children:"\ud83d\udfe0 only when the hook triggers"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Supports multiple versions"}),(0,r.jsx)(n.td,{children:"\ud83d\udfe2"}),(0,r.jsx)(n.td,{children:"\ud83d\udfe2"}),(0,r.jsx)(n.td,{children:"\ud83d\udfe2"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Fixed to a single version"}),(0,r.jsx)(n.td,{children:"\ud83d\udfe0 with arg or env var"}),(0,r.jsx)(n.td,{children:"\ud83d\udfe2"}),(0,r.jsx)(n.td,{children:"\ud83d\udfe0 if not using shims"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Includes all tool executables"}),(0,r.jsx)(n.td,{children:"\ud83d\udd34"}),(0,r.jsx)(n.td,{children:"\ud83d\udd34"}),(0,r.jsx)(n.td,{children:"\ud83d\udfe2"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Includes tool globals/packages"}),(0,r.jsx)(n.td,{children:"\ud83d\udd34"}),(0,r.jsx)(n.td,{children:"\ud83d\udd34"}),(0,r.jsx)(n.td,{children:"\ud83d\udfe2"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Exports environment variables"}),(0,r.jsx)(n.td,{children:"\ud83d\udd34"}),(0,r.jsx)(n.td,{children:"\ud83d\udd34"}),(0,r.jsx)(n.td,{children:"\ud83d\udfe2"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Prepends ",(0,r.jsx)(n.code,{children:"PATH"})]}),(0,r.jsx)(n.td,{children:"\ud83d\udd34"}),(0,r.jsx)(n.td,{children:"\ud83d\udd34"}),(0,r.jsx)(n.td,{children:"\ud83d\udfe2"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Can pin proto's version"}),(0,r.jsx)(n.td,{children:"\ud83d\udd34"}),(0,r.jsx)(n.td,{children:"\ud83d\udd34"}),(0,r.jsx)(n.td,{children:"\ud83d\udfe2"})]})]})]})]})}function x(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);