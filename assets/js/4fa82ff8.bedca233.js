"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[33104],{53070:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"how-it-works/languages","title":"Languages","description":"Although moon is currently focusing on the JavaScript ecosystem, our long-term vision is to be a","source":"@site/docs/how-it-works/languages.mdx","sourceDirName":"how-it-works","slug":"/how-it-works/languages","permalink":"/docs/how-it-works/languages","draft":false,"unlisted":false,"editUrl":"https://github.com/moonrepo/moon/tree/master/website/docs/how-it-works/languages.mdx","tags":[],"version":"current","frontMatter":{"title":"Languages"},"sidebar":"docs","previous":{"title":"How it works","permalink":"/docs/how-it-works"},"next":{"title":"Project graph","permalink":"/docs/how-it-works/project-graph"}}');var i=a(62540),s=a(43023);a(63696),a(79035);const o={title:"Languages"},r=void 0,l={},c=[{value:"Enabling a language",id:"enabling-a-language",level:2},{value:"System language and toolchain",id:"system-language-and-toolchain",level:2},{value:"Tier structure and responsibilities",id:"tier-structure-and-responsibilities",level:2},{value:"Tier 0 = Unsupported",id:"tier-0--unsupported",level:3},{value:"Tier 1 = Language",id:"tier-1--language",level:3},{value:"Tier 2 = Ecosystem",id:"tier-2--ecosystem",level:3},{value:"Tier 3 = Toolchain",id:"tier-3--toolchain",level:3}];function d(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Although moon is currently focusing on the JavaScript ecosystem, our long-term vision is to be a\nmulti-language task runner and monorepo management tool. To that end, our languages (known as\ntoolchains) are implemented as WASM plugins, where their functionality is implemented in isolation,\nand is ",(0,i.jsx)(n.em,{children:"opt-in"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"enabling-a-language",children:"Enabling a language"}),"\n",(0,i.jsxs)(n.p,{children:["moon ",(0,i.jsx)(n.a,{href:"../#supported-languages",children:"supported languages"})," are opt-in, and ",(0,i.jsx)(n.em,{children:"are not"})," enabled by default. We\nchose this pattern to avoid unnecessary overhead, especially for the future when we have 10 or more\nbuilt-in languages."]}),"\n",(0,i.jsxs)(n.p,{children:["To enable a supported language, simply define a configuration block with the language's name in\n",(0,i.jsx)(n.a,{href:"../config/toolchain",children:(0,i.jsx)(n.code,{children:".moon/toolchains.*"})}),". Even an empty block will enable the language."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title=".moon/toolchains.yml"',children:"# Enable JavaScript\njavascript: {}\n\n# Enable JavaScript with custom settings\njavascript:\n  packageManager: 'pnpm'\n\n# Enable TypeScript\ntypescript: {}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"system-language-and-toolchain",children:"System language and toolchain"}),"\n",(0,i.jsxs)(n.p,{children:["When working with moon, you'll most likely have tasks that run built-in system commands that do not\nbelong to any of the supported languages. For example, you may have a task that runs ",(0,i.jsx)(n.code,{children:"git"})," or\n",(0,i.jsx)(n.code,{children:"docker"})," commands, or common commands like ",(0,i.jsx)(n.code,{children:"rm"}),", ",(0,i.jsx)(n.code,{children:"cp"}),", ",(0,i.jsx)(n.code,{children:"mv"}),", etc."]}),"\n",(0,i.jsxs)(n.p,{children:["For these cases, moon provides a special language/toolchain called ",(0,i.jsx)(n.code,{children:"system"}),", that is always enabled.\nThis toolchain is a catch-all, an escape-hatch, a fallback, and provides the following:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Runs a system command or a binary found on ",(0,i.jsx)(n.code,{children:"PATH"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Wraps the execution in a shell."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["To run system commands, set a task's ",(0,i.jsx)(n.a,{href:"../config/project#toolchain",children:(0,i.jsx)(n.code,{children:"toolchain"})}),' setting to "system".']}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="moon.yml"',children:"tasks:\n  example:\n    command: 'git status'\n    toolchain: 'system'\n"})}),"\n",(0,i.jsx)(n.h2,{id:"tier-structure-and-responsibilities",children:"Tier structure and responsibilities"}),"\n",(0,i.jsxs)(n.p,{children:["As mentioned in our introduction,\n",(0,i.jsx)(n.a,{href:"../#supported-languages",children:"language support is divided up into tiers"}),", where each tier introduces\nmore internal integrations and automations, but requires more work to properly implement."]}),"\n",(0,i.jsx)(n.h3,{id:"tier-0--unsupported",children:"Tier 0 = Unsupported"}),"\n",(0,i.jsxs)(n.p,{children:["The zero tier represents all languages ",(0,i.jsx)(n.em,{children:"not directly"})," supported by moon. This tier merely exists as\na mechanism for running non-supported language binaries via the\n",(0,i.jsx)(n.a,{href:"#system-language-and-toolchain",children:"system toolchain"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="moon.yml"',children:"tasks:\n  example:\n    command: 'ruby'\n    toolchain: 'system'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"tier-1--language",children:"Tier 1 = Language"}),"\n",(0,i.jsx)(n.p,{children:"The first tier is the language itself. This is the most basic level of support, and is the only tier\nthat is required to be implemented for a language to be considered minimally supported. This tier is\nin charge of:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Declaring metadata about the language. For example, the name of the binary, supported file\nextensions, available dependency/package/version managers, names of config/manifest/lock files,\netc."}),"\n",(0,i.jsx)(n.li,{children:"Mechanisms for detecting the language of a project based on config files and other criteria."}),"\n",(0,i.jsxs)(n.li,{children:["Maps to a project's ",(0,i.jsx)(n.a,{href:"../config/project#language",children:(0,i.jsx)(n.code,{children:"language"})})," setting."]}),"\n",(0,i.jsxs)(n.li,{children:["Supports a configuration block by name in ",(0,i.jsx)(n.a,{href:"../config/toolchain",children:(0,i.jsx)(n.code,{children:".moon/toolchains.*"})}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="moon.yml"',children:"language: 'javascript'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"tier-2--ecosystem",children:"Tier 2 = Ecosystem"}),"\n",(0,i.jsx)(n.p,{children:"The second tier requires the language functionality from tier 1, and eventually the toolchain\nfunctionality from tier 3, and provides interoperability with moon's internals. This is the most\ncomplex of all tiers, and the tier is in charge of:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Determining when, where, and how to install dependencies for a project or the workspace."}),"\n",(0,i.jsx)(n.li,{children:"Loading project aliases and inferring implicit relationships between projects."}),"\n",(0,i.jsx)(n.li,{children:"Syncing a project and ensuring a healthy project state."}),"\n",(0,i.jsx)(n.li,{children:"Hashing efficiently for dependency installs and target runs."}),"\n",(0,i.jsx)(n.li,{children:"Helpers for parsing lockfiles and manifest files, and interacting with the language's ecosystem\n(for example, Node.js module resolution)."}),"\n",(0,i.jsxs)(n.li,{children:["Prepending ",(0,i.jsx)(n.code,{children:"PATH"})," with appropriate lookups to execute a task."]}),"\n",(0,i.jsx)(n.li,{children:"Running a target's command with proper arguments, environment variables, and flags."}),"\n",(0,i.jsxs)(n.li,{children:["Maps to a project's ",(0,i.jsx)(n.a,{href:"../config/project#toolchain-1",children:(0,i.jsx)(n.code,{children:"toolchains.default"})})," or task's\n",(0,i.jsx)(n.a,{href:"../config/project#toolchain",children:(0,i.jsx)(n.code,{children:"toolchains"})})," setting."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="moon.yml"',children:"tasks:\n  example:\n    command: 'webpack'\n    toolchain: 'node'\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title=".moon/toolchains.yml"',children:"javascript: {}\nnode: {}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"tier-3--toolchain",children:"Tier 3 = Toolchain"}),"\n",(0,i.jsxs)(n.p,{children:["The third tier is toolchain support via ",(0,i.jsx)(n.a,{href:"/proto",children:"proto"}),". This is the final tier, as the toolchain is\nunusable unless the platform has been entirely integrated, and as such, the platform depends on this\ntier. This tier handles:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Downloading and installing a language into the toolchain."}),"\n",(0,i.jsx)(n.li,{children:"Installing and deduping project dependencies."}),"\n",(0,i.jsx)(n.li,{children:"Detecting appropriate versions of tools to use."}),"\n",(0,i.jsx)(n.li,{children:"Determining which binary to use and execute targets with."}),"\n",(0,i.jsxs)(n.li,{children:["Supports a ",(0,i.jsx)(n.code,{children:"version"})," field in the named configuration block in\n",(0,i.jsx)(n.a,{href:"../config/toolchain",children:(0,i.jsx)(n.code,{children:".moon/toolchains.*"})}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title=".moon/toolchains.yml"',children:"node:\n  version: '18.0.0'\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},79035:(e,n,a)=>{a.d(n,{D:()=>o});var t=a(60359),i=a(51571),s=a.n(i);function o(e,n){return(0,t.A)({container:e,elements:n,layout:{fit:!0,name:"dagre",nodeDimensionsIncludeLabels:!0,spacingFactor:1},style:[{selector:"edges",style:{"arrow-scale":2,color:"#e4f7fb","curve-style":"straight","font-size":12,label:"data(label)","line-cap":"round","line-color":"#c9eef6","line-opacity":.25,"overlay-color":"#c9eef6","target-arrow-color":"#c9eef6","target-arrow-shape":"chevron","text-opacity":.6,width:3}},{selector:"node",style:{"background-fill":"linear-gradient","background-gradient-direction":"to-bottom-right","background-gradient-stop-colors":"#d7dfe9 #bdc9db #97a1af",color:"#fff",height:60,label:"data(label)","overlay-color":"#99aab7","overlay-shape":"ellipse",padding:"0",shape:"ellipse","text-halign":"center","text-margin-y":6,"text-valign":"bottom","underlay-shape":"ellipse",width:60}},{selector:'node[type="run-task"]',style:{"background-gradient-stop-colors":"#6e58d1 #4a2ec6 #3b259e"}},{selector:'node[type="run-target"]',style:{"background-gradient-stop-colors":"#6e58d1 #4a2ec6 #3b259e"}},{selector:'node[type="sync-project"]',style:{"background-gradient-stop-colors":"#ffafff #ff79ff #cc61cc",height:80,width:80}},{selector:'node[type="install-dependencies"]',style:{"background-gradient-stop-colors":"#afe6f2 #79d5e9 #61aaba",height:90,width:90}},{selector:'node[type="setup-environment"]',style:{"background-gradient-stop-colors":"#c9e166 #b7d733 #a5cd00",height:90,width:90}},{selector:'node[type="setup-toolchain"]',style:{"background-gradient-stop-colors":"#ff9da6 #ff5b6b #cc4956",height:100,width:100}},{selector:'node[type="setup-proto"]',style:{"background-gradient-stop-colors":"#ffafff #ff79ff #cc61cc",height:110,width:110}},{selector:'node[id="sync-workspace"]',style:{"background-gradient-stop-colors":"#b7a9f9 #9a87f7 #8c75f5",height:120,width:120}}]})}t.A.use(s())}}]);