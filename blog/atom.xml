<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://moonrepo.dev/blog</id>
    <title>moonrepo Blog</title>
    <updated>2025-07-24T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://moonrepo.dev/blog"/>
    <subtitle>moonrepo Blog</subtitle>
    <icon>https://moonrepo.dev/img/favicon.svg</icon>
    <entry>
        <title type="html"><![CDATA[moon v1.39 - Improved task inputs, better proto integration, and project layers]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.39</id>
        <link href="https://moonrepo.dev/blog/moon-v1.39"/>
        <updated>2025-07-24T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[This is a rather small release, but it does include some important changes to task inputs, and]]></summary>
        <content type="html"><![CDATA[<p>This is a rather small release, but it does include some important changes to task inputs, and
proto's integration.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-task-inputs">Improved task inputs<a href="https://moonrepo.dev/blog/moon-v1.39#improved-task-inputs" class="hash-link" aria-label="Direct link to Improved task inputs" title="Direct link to Improved task inputs">​</a></h2>
<p>A few months ago we introduced an
<a href="https://github.com/moonrepo/moon/issues/1985" target="_blank" rel="noopener noreferrer">RFC for improving task inputs</a> that introduces new
syntax, functionality, and input types. In this release, we have implemented a portion of the RFC
for testing before we implement the rest. Continue reading for more details!</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="new-formats">New formats<a href="https://moonrepo.dev/blog/moon-v1.39#new-formats" class="hash-link" aria-label="Direct link to New formats" title="Direct link to New formats">​</a></h3>
<p>To start, we are introducing 2 new formats for configuring task inputs, a URI format and an object
format, both of which support custom parameters.</p>
<h4 class="anchor anchorWithStickyNavbar_JmGV" id="uris">URIs<a href="https://moonrepo.dev/blog/moon-v1.39#uris" class="hash-link" aria-label="Direct link to URIs" title="Direct link to URIs">​</a></h4>
<p>URIs should be rather familiar, as they are a string prefixed with a scheme (<code>://</code>), followed by a
value, and an optional list of query parameters (<code>?</code>). Currently files can be specified using the
<a href="https://moonrepo.dev/docs/config/project#file-paths"><code>file://</code> scheme</a>, and globs with the
<a href="https://moonrepo.dev/docs/config/project#glob-patterns"><code>glob://</code> scheme</a>. Environment variables do not support URIs.</p>
<div class="language-yml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'file:///*.config.js?optional'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'glob://src/**/*.ts'</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>Files and globs can still be configured using literal strings. The URI format can be used when
customizing parameters!</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_JmGV" id="objects">Objects<a href="https://moonrepo.dev/blog/moon-v1.39#objects" class="hash-link" aria-label="Direct link to Objects" title="Direct link to Objects">​</a></h4>
<p>Objects provide an alternative to strings, allowing you to customize parameters in a standard and
familiar format. Files can be specified using the <a href="https://moonrepo.dev/docs/config/project#file-paths"><code>file</code> key</a>, and
globs with the <a href="https://moonrepo.dev/docs/config/project#glob-patterns"><code>glob</code> key</a>. Environment variables do not
support objects.</p>
<div class="language-yml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token key atrule">file</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'/*.config.js'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">        </span><span class="token key atrule">optional</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token key atrule">glob</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'src/**/*.ts'</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="new-parameters">New parameters<a href="https://moonrepo.dev/blog/moon-v1.39#new-parameters" class="hash-link" aria-label="Direct link to New parameters" title="Direct link to New parameters">​</a></h3>
<p>As mentioned above, file and glob inputs now support parameters, which can be customized using URI
and object formats. The following parameters are available:</p>
<h4 class="anchor anchorWithStickyNavbar_JmGV" id="files">Files<a href="https://moonrepo.dev/blog/moon-v1.39#files" class="hash-link" aria-label="Direct link to Files" title="Direct link to Files">​</a></h4>
<ul>
<li><code>content</code> (<code>string</code>) - When determining affected state, will match against the file's content
using the defined regex pattern, instead of relying on file existence.</li>
<li><code>optional</code> (<code>boolean</code>) - When hashing and set to <code>true</code> and the file is missing, will not log a
warning. When set to <code>false</code> and the file is missing, will fail with an error. Defaults to logging
a warning.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_JmGV" id="globs">Globs<a href="https://moonrepo.dev/blog/moon-v1.39#globs" class="hash-link" aria-label="Direct link to Globs" title="Direct link to Globs">​</a></h4>
<ul>
<li><code>cache</code> (<code>boolean</code>) - When gathering inputs for hashing, defines whether the glob results should
be cached for the duration of the moon process. Defaults to <code>true</code>.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="better-proto-integration">Better proto integration<a href="https://moonrepo.dev/blog/moon-v1.39#better-proto-integration" class="hash-link" aria-label="Direct link to Better proto integration" title="Direct link to Better proto integration">​</a></h2>
<p>In previous versions of moon, we would automatically install <a href="https://moonrepo.dev/proto">proto</a> for you based on
certain conditions. This logic was applied to all <code>moon</code> sub-commands, which was not necessary, as
it was only required for task running related commands.</p>
<p>To improve this, we have integrated proto into the action pipeline through a new action,
<code>SetupProto</code>, which runs before any <code>SetupToolchain</code> action. With this, proto is only installed when
required by that specific toolchain, and not for every command.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="new-proto-setting">New <code>proto</code> setting<a href="https://moonrepo.dev/blog/moon-v1.39#new-proto-setting" class="hash-link" aria-label="Direct link to new-proto-setting" title="Direct link to new-proto-setting">​</a></h3>
<p>Additionally, we are introducing a <a href="https://moonrepo.dev/docs/config/toolchain#proto"><code>proto</code></a> setting in
<a href="https://moonrepo.dev/docs/config/toolchain"><code>.moon/toolchain.yml</code></a>, which can be used to control the integration of
proto in moon. To start, you can now customize the proto version! This is extremely useful if you
want to test new proto features, or need to rollback to an older version.</p>
<div class="language-yml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/toolchain.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">proto</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">version</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'0.51.4'</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.39#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h3>
<p>Lastly, proto has been upgrade to <a href="https://github.com/moonrepo/proto/releases/tag/v0.51.0" target="_blank" rel="noopener noreferrer">v0.51</a>,
which includes 2 major features: lockfiles and custom registries. However, we have yet to test these
features thoroughly in moon, so they are not "officially" supported yet, but you can still use them
if you wish. We will be adding support for these features in the future.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="project-layers">Project layers<a href="https://moonrepo.dev/blog/moon-v1.39#project-layers" class="hash-link" aria-label="Direct link to Project layers" title="Direct link to Project layers">​</a></h2>
<p>Project layers may sound like a new feature, but they are simply a rename of the project type. Going
forward, the <code>type</code> setting in <a href="https://moonrepo.dev/docs/config/project"><code>moon.yml</code></a> has been renamed to
<a href="https://moonrepo.dev/docs/config/project#layer"><code>layer</code></a>, but backwards compatibility will be maintained until v2. Why
the rename?</p>
<p>The term "layer" better reflects the purpose and functionality of this concept, as it defines a
layer (the <a href="https://moonrepo.dev/docs/config/project#layer"><code>layer</code></a> setting) within the development stack (the
<a href="https://moonrepo.dev/docs/config/project#stack"><code>stack</code></a> setting), and helps to enforce proper relationships. This
change aims to improve clarity and consistency in our configuration.</p>
<p>For example, the following layers are available, from highest to lowest. Layers can then depend on
lower layers, but not higher layers. Except for automations and applications, they can also depend
on themself.</p>
<table><thead><tr><th>Layer</th><th>Description</th></tr></thead><tbody><tr><td><code>automation</code></td><td>An automated testing suite, like E2E, integration, or visual tests.</td></tr><tr><td><code>application</code></td><td>An application of any kind.</td></tr><tr><td><code>tool</code></td><td>An internal tool, CLI, one-off script, etc.</td></tr><tr><td><code>library</code></td><td>A self-contained, shareable, and publishable set of code.</td></tr><tr><td><code>scaffolding</code></td><td>Templates or generators for scaffolding.</td></tr><tr><td><code>configuration</code></td><td>Configuration files or infrastructure.</td></tr><tr><td><code>unknown</code></td><td>When not configured.</td></tr></tbody></table>
<p>Because of this rename, the following changes have been made:</p>
<ul>
<li><code>type</code> --&gt; <code>layer</code> in <code>moon.yml</code></li>
<li><code>--type</code> --&gt; <code>--layer</code> in <code>moon query projects</code></li>
<li><code>projectType</code> --&gt; <code>projectLayer</code> for MQL</li>
<li><code>$projectType</code> --&gt; <code>$projectLayer</code> for task tokens</li>
<li><code>enforceProjectTypeRelationships</code> --&gt; <code>enforceLayerRelationships</code> in <code>.moon/workspace.yml</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes-1">Other changes<a href="https://moonrepo.dev/blog/moon-v1.39#other-changes-1" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.39.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added unstable support for bubbling up logs from WASM plugins.</li>
<li>Updated the <code>@moonrepo/cli</code> npm package to no longer rely on postinstall scripts.</li>
<li>Improved argument quoting for commands and scripts.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="whats-next">What's next?<a href="https://moonrepo.dev/blog/moon-v1.39#whats-next" class="hash-link" aria-label="Direct link to What's next?" title="Direct link to What's next?">​</a></h2>
<p>With toolchains plugins being stabilized more, we'd like to focus on some other areas.</p>
<ul>
<li>Better command line argument parsing/joining (especially for task <code>args</code>)</li>
<li>Pkl configuration improvements</li>
<li>WASM toolchain documentation</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="task" term="task"/>
        <category label="input" term="input"/>
        <category label="uri" term="uri"/>
        <category label="object" term="object"/>
        <category label="proto" term="proto"/>
        <category label="project" term="project"/>
        <category label="layer" term="layer"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.51 - Unstable lockfiles and plugin registries]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.51</id>
        <link href="https://moonrepo.dev/blog/proto-v0.51"/>
        <updated>2025-07-17T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[With this release, we're excited to introduce two major features that pave the way for proto's]]></summary>
        <content type="html"><![CDATA[<p>With this release, we're excited to introduce two major features that pave the way for proto's
future!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="unstable-lockfile-support">Unstable lockfile support<a href="https://moonrepo.dev/blog/proto-v0.51#unstable-lockfile-support" class="hash-link" aria-label="Direct link to Unstable lockfile support" title="Direct link to Unstable lockfile support">​</a></h2>
<p>Lockfiles have been requested by the community since proto's inception, but adopting them has been a
non-trivial task, as it requires touching almost every aspect of proto. With that said, we've been
slowly reworking the internals to support lockfiles, and with this release, we're introducing
unstable support for them!</p>
<p>If you're unaware of what lockfiles are, they allow you to pin the exact version (and checksum) of a
tool that is installed, ensuring that your development environment is consistent and reproducible.
If you've used package managers like npm, Cargo, or uv, you're likely familiar with this concept.</p>
<p>In proto, the concept of lockfiles is mostly the same, but the manner in which they are created and
updated may differ based on other tools. To start, lockfiles in proto are <em>opt-in</em> and can be
enabled with the new <a href="https://moonrepo.dev/docs/proto/config#unstable-lockfile"><code>settings.unstable-lockfile</code></a> setting in
<code>.prototools</code>.</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.prototools</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">settings</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">unstable-lockfile</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">true</span><br></span></code></pre></div></div>
<p>This will create a <code>.protolock</code> file in the current directory, relative to the <code>.prototools</code> file.
In effect, this locks that directory and all of its subdirectories. As a side-effect, nested
lockfiles are not supported.</p>
<p>To demonstrate how lockfiles work, installing the following tools with <code>proto install</code>...</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.prototools</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key property" style="color:#b7a9f9">bun</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"1.2.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">deno</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2.4.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">node</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"22.17.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">settings</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">unstable-lockfile</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">true</span><br></span></code></pre></div></div>
<p>... would generate the following <code>.protolock</code> file:</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.protolock</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># Generated by proto. Do not modify!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">tools.bun</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">spec</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"1.2.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">version</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"1.2.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">checksum</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"sha256:fa72173cb2220d00e2d2650fefdc0b5b37bfd8bb33d8d671b50efb409c2f5745"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">tools.deno</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">spec</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2.4.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">version</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2.4.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">checksum</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"sha256:c913d018d64c48dcc5b7b90d844efb6d017595a7c1e237f89141df1b3ef8b962"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">tools.node</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">spec</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"22.17.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">version</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"22.17.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">checksum</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"sha256:cc9cc294eaf782dd93c8c51f460da610cc35753c6a9947411731524d16e97914"</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="updated-workflows">Updated workflows<a href="https://moonrepo.dev/blog/proto-v0.51#updated-workflows" class="hash-link" aria-label="Direct link to Updated workflows" title="Direct link to Updated workflows">​</a></h3>
<p>The <a href="https://moonrepo.dev/docs/proto/commands/run"><code>proto run</code></a> (shims),
<a href="https://moonrepo.dev/docs/proto/commands/install"><code>proto install</code></a>, and
<a href="https://moonrepo.dev/docs/proto/commands/uninstall"><code>proto uninstall</code></a> commands have been updated to support lockfiles.</p>
<p>When running or installing tools and a matching specification exists in the lockfile, the locked
version will be inherited even if there's a newer version upstream, and the tool's checksum will be
validated when available. These checks can be bypassed with the new <code>--update-lockfile</code> flag
(install only).</p>
<p>Inversely, when uninstalling tools, the lockfile will be updated to remove any matching
specification records.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="still-a-work-in-progress">Still a work in progress<a href="https://moonrepo.dev/blog/proto-v0.51#still-a-work-in-progress" class="hash-link" aria-label="Direct link to Still a work in progress" title="Direct link to Still a work in progress">​</a></h3>
<p>We are marking lockfiles as unstable as they have not been fully implemented or thoroughly tested.
There are other commands like <a href="https://moonrepo.dev/docs/proto/commands/outdated"><code>proto outdated</code></a> and
<a href="https://moonrepo.dev/docs/proto/commands/status"><code>proto status</code></a> that are not lockfile aware yet, but will be in the
future.</p>
<p>But please, give them a whirl and let us know what you think!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="unstable-oci-registries-for-plugin-storage">Unstable OCI registries for plugin storage<a href="https://moonrepo.dev/blog/proto-v0.51#unstable-oci-registries-for-plugin-storage" class="hash-link" aria-label="Direct link to Unstable OCI registries for plugin storage" title="Direct link to Unstable OCI registries for plugin storage">​</a></h2>
<p>Another important feature that is necessary for proto's success is support for an official plugin
registry. Before we get to that, we need to lay the groundwork for how plugins are stored and
distributed. With this release, we're introducing unstable support for
<a href="https://opencontainers.org/" target="_blank" rel="noopener noreferrer">OCI registries</a> as a storage mechanism for plugins. If you're
unfamiliar with OCI registries, they are a standard for storing and distributing container images
(Docker), but can also be used to store other types of
<a href="https://oras.land/docs/concepts/artifact" target="_blank" rel="noopener noreferrer">artifacts</a>, in this case, WASM plugins.</p>
<p>To support registries, we have introduced a new
<a href="https://moonrepo.dev/docs/proto/config#unstable-registries"><code>settings.unstable-registries</code></a> setting in <code>.prototools</code>,
which allows you to configure a list of registries to query for applicable plugins. For example:</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.prototools</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">settings</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">unstable-registries</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"> registry: </span><span class="token string" style="color:#c9e166">"ghcr.io"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"> namespace: </span><span class="token string" style="color:#c9e166">"moonrepo"</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">]</span><br></span></code></pre></div></div>
<p>Additionally, we are introducing a new <code>registry://</code> plugin locator, which allows you to configure a
plugin by its OCI reference.</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.prototools</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">plugins</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Longform with tag</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">bun</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"registry://ghcr.io/moonrepo/bun_tool:v1.2.3"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Longform without tag</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">bun</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"registry://ghcr.io/moonrepo/bun_tool"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Shortform with tag</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">bun</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"registry://bun_tool:v1.2.3"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Shortform without tag</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">bun</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"registry://bun_tool"</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="how-it-works">How it works<a href="https://moonrepo.dev/blog/proto-v0.51#how-it-works" class="hash-link" aria-label="Direct link to How it works" title="Direct link to How it works">​</a></h3>
<p>Using a container registry to store plugins seems odd at first, but it actually allows us to
leverage existing specifications, infrastructure, and tools to manage and distribute plugins. We
don't want to re-invent the wheel here, so why not use something that most of the industry is
already using?</p>
<p>With that said, how does this work in proto? Since we are not a container image, we use the
<a href="https://oras.land/docs/concepts/artifact" target="_blank" rel="noopener noreferrer">artifact portion of the specification</a> instead.
Primarily, plugins are stored in layers! The blob/content of WASM, TOML, JSON, and YAML plugins are
stored in CAS, and referenced in layers by a sha256 digest.</p>
<p>As for annotations, we support the
<a href="https://github.com/opencontainers/image-spec/blob/main/annotations.md" target="_blank" rel="noopener noreferrer">OCI standard annotations</a>,
but will also support moonrepo-specific annotations in the future.</p>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>At this time, we do not provide a mechanism for uploading plugins to a registry. You'll need to do
that manually.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="official-registry">Official registry?<a href="https://moonrepo.dev/blog/proto-v0.51#official-registry" class="hash-link" aria-label="Direct link to Official registry?" title="Direct link to Official registry?">​</a></h3>
<p>We do have plans to support an official moonrepo plugin registry, for both proto and moon. We are in
the process of investigating solutions to this and will provide more details soon.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.51#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.51.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Removed <code>--canary</code> from <code>proto install</code>, just use <code>canary</code> as the version specifier instead.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="looking-for-contributors">Looking for contributors<a href="https://moonrepo.dev/blog/proto-v0.51#looking-for-contributors" class="hash-link" aria-label="Direct link to Looking for contributors" title="Direct link to Looking for contributors">​</a></h2>
<p>We have a lot of cool stuff planned for proto, like backend plugins, more official tools, improved
workflows, an official registry, and more! So if you're interested in Rust or WASM, we would love
and appreciate your help. Feel free to ping us on Discord!</p>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="lockfile" term="lockfile"/>
        <category label="record" term="record"/>
        <category label="registry" term="registry"/>
        <category label="oci" term="oci"/>
        <category label="plugin" term="plugin"/>
        <category label="locator" term="locator"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.38 - Go WASM toolchain, MCP tools, terminal notifications, and more!]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.38</id>
        <link href="https://moonrepo.dev/blog/moon-v1.38"/>
        <updated>2025-06-24T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we're stoked to release the Go WASM toolchain plugin, and improved MCP/AI support!]]></summary>
        <content type="html"><![CDATA[<p>In this release, we're stoked to release the Go WASM toolchain plugin, and improved MCP/AI support!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="rfc-task-inheritance-via-inline-configuration">RFC: Task inheritance via inline configuration<a href="https://moonrepo.dev/blog/moon-v1.38#rfc-task-inheritance-via-inline-configuration" class="hash-link" aria-label="Direct link to RFC: Task inheritance via inline configuration" title="Direct link to RFC: Task inheritance via inline configuration">​</a></h2>
<p>Task inheritance is one of moon's most powerful features, allowing you to define tasks at the
top-level and have them automatically inherited by projects that match certain conditions. In it's
current form, task inheritance is based on the file name of the configuration file, but this
approach has several limitations.</p>
<p>We're planning to improve task inheritance and have written up an
<a href="https://github.com/moonrepo/moon/issues/2023" target="_blank" rel="noopener noreferrer">RFC to discuss these changes</a>. We'd appreciate any
and all feedback!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-go-toolchain-powered-by-wasm">New Go toolchain powered by WASM<a href="https://moonrepo.dev/blog/moon-v1.38#new-go-toolchain-powered-by-wasm" class="hash-link" aria-label="Direct link to New Go toolchain powered by WASM" title="Direct link to New Go toolchain powered by WASM">​</a></h2>
<p>Official Go toolchain support has been requested by the community for a long time now, and with the
somewhat stabilization of WASM plugins and the introduction of the
<a href="https://moonrepo.dev/blog/moon-v1.37">Rust toolchain in the last release</a>, we felt it was finally time to add Go! To enable
Go, run our new command or add an <a href="https://moonrepo.dev/docs/config/toolchain#unstable_go"><code>unstable_go</code></a> entry to
<code>.moon/toolchain.yml</code>.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon toolchain </span><span class="token function" style="color:#ff94ff;font-weight:bold">add</span><span class="token plain"> unstable_go</span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/toolchain.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">unstable_go</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">version</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'1.24.0'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">workspaces</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre></div></div>
<p>The Go toolchain releases with full <a href="https://moonrepo.dev/docs/how-it-works/languages">tier 1, 2, and 3 support</a>!
Additionally, the following features and functionality is available when enabling the toolchain:</p>
<ul>
<li>Supports Go workspaces through the <code>go.work</code> file. Can be disabled with the
<a href="https://moonrepo.dev/docs/config/toolchain#unstable_go"><code>unstable_go.workspaces</code></a> setting.</li>
<li>Extracts the <code>go.mod</code> <code>module</code> directive as a project alias.</li>
<li>Extracts project relationships and dependency information from <code>go.mod</code> <code>require</code> directives.</li>
<li>Extracts version and checksum information from <code>go.sum</code> and <code>go.work.sum</code> files.</li>
<li>Injects Go globals directory (<code>GOBIN</code>) into task command/script child processes.</li>
<li>Supports installing Go globals via <code>go install</code> commands. Can be customized with the
<a href="https://moonrepo.dev/docs/config/toolchain#unstable_go"><code>unstable_go.bins</code></a> setting.</li>
<li>Automatically runs <code>go mod</code> or <code>go work</code> commands when installing dependencies.</li>
<li>Basic Docker image and pruning support.</li>
</ul>
<p>We hope you enjoy this new Go toolchain. With that said, we are <em>not</em> Go experts, and would love to
hear from you on what works, what doesn't, what can be improved, and what features you would like to
see added!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-mcp-tools">New MCP tools<a href="https://moonrepo.dev/blog/moon-v1.38#new-mcp-tools" class="hash-link" aria-label="Direct link to New MCP tools" title="Direct link to New MCP tools">​</a></h2>
<p>In our last release, we introduced the <a href="https://moonrepo.dev/blog/moon-v1.37#mcp-editor-integration"><code>moon mcp</code> command</a>,
offering deep editor integration with AI models like GitHub Copilot and Cursor. This release expands
on that by introducing 3 more tools to utilize:</p>
<ul>
<li><code>get_touched_files</code> - Gets touched files between base and head revisions.</li>
<li><code>sync_projects</code> - Runs the <code>SyncProject</code> action for one or many projects by <code>id</code>.</li>
<li><code>sync_workspace</code> - Runs the <code>SyncWorkspace</code> action.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-os-terminal-notifications">New OS terminal notifications<a href="https://moonrepo.dev/blog/moon-v1.38#new-os-terminal-notifications" class="hash-link" aria-label="Direct link to New OS terminal notifications" title="Direct link to New OS terminal notifications">​</a></h2>
<p>This was a feature we originally scoped out during moon's inception, almost 3 years ago, but we
never got around to implementing it. However, there has been some improvements to native operating
system notifications in Rust lately, so it felt like a good time to finally implement it!</p>
<p>And on that note, we are introducing a new
<a href="https://moonrepo.dev/docs/config/workspace#terminalnotifications"><code>notifier.terminalNotifications</code></a> setting that allows
you to receive terminal notifications for pipeline events.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">notifier</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">terminalNotifications</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'failure'</span><br></span></code></pre></div></div>
<blockquote>
<p>View the <a href="https://moonrepo.dev/docs/guides/notifications">official guide</a> for more information!</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.38#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.38.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added new <code>moon toolchain</code> command and sub-commands.<!-- -->
<ul>
<li>Add a toolchain to <code>.moon/toolchain.yml</code> with <code>moon toolchain add</code>.</li>
<li>View information about a toolchain plugin with <code>moon toolchain info</code>.</li>
</ul>
</li>
<li>Added a <code>notifier.webhookAcknowledge</code> setting, that ensures webhooks resolve with a 2XX status
code.</li>
<li>Updated proto to <a href="https://github.com/moonrepo/proto/releases/tag/v0.50.0" target="_blank" rel="noopener noreferrer">v0.50.1</a> (from 0.49.4).</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="whats-next">What's next?<a href="https://moonrepo.dev/blog/moon-v1.38#whats-next" class="hash-link" aria-label="Direct link to What's next?" title="Direct link to What's next?">​</a></h2>
<p>With toolchains plugins being stabilized more, we'd like to focus on some other areas.</p>
<ul>
<li>Better command line argument parsing/joining (especially for task <code>args</code>)</li>
<li>Better child process I/O piping</li>
<li>WASM toolchain documentation</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="toolchain" term="toolchain"/>
        <category label="wasm" term="wasm"/>
        <category label="plugin" term="plugin"/>
        <category label="go" term="go"/>
        <category label="mcp" term="mcp"/>
        <category label="ai" term="ai"/>
        <category label="webhooks" term="webhooks"/>
        <category label="terminal" term="terminal"/>
        <category label="notifications" term="notifications"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.50 - URL rewrites, on-init activation, preserved comments, and more]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.50</id>
        <link href="https://moonrepo.dev/blog/proto-v0.50"/>
        <updated>2025-06-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we're landing a handful of quality of life improvements that have been requested by]]></summary>
        <content type="html"><![CDATA[<p>In this release, we're landing a handful of quality of life improvements that have been requested by
the community.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="rewrite-urls-for-better-interoperability">Rewrite URLs for better interoperability<a href="https://moonrepo.dev/blog/proto-v0.50#rewrite-urls-for-better-interoperability" class="hash-link" aria-label="Direct link to Rewrite URLs for better interoperability" title="Direct link to Rewrite URLs for better interoperability">​</a></h2>
<p>proto is heavily reliant on URLs, as they power everything from tool and plugin downloading to
version resolving. Many URLs are hard-coded into proto but most of them come from plugins. For the
most part this is fine, but if you work within a corporate environment, or have a firewall, you may
have to deal with proxy servers, mirrors, or other factors.</p>
<p>Until now, this was very difficult to circumvent, so we wanted to provide a built-in solution to
this problem, and as such, we're introducing the new
<a href="https://moonrepo.dev/docs/proto/config#url-rewrites"><code>url-rewrites</code></a> configuration setting. This setting accepts a map
of regex patterns to replacements, and will rewrite URLs that match the pattern.</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.prototools</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">settings.url-rewrites</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">"github.com/(\\w+)/(\\w+)"</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"gh-mirror.corp.com/$1/$2"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">"mo+n"</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"lunar"</span><br></span></code></pre></div></div>
<p>For example, in the configuration above, any URL that contains <code>github.com</code> will be replaced with
<code>gh-mirror.corp.com</code>, and any URL that contains the word "moon" (with different length o's) will be
replaced with "lunar". Learn more about URL rewriting in the settings documentation!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="activation-flow-now-triggers-immediately">Activation flow now triggers immediately<a href="https://moonrepo.dev/blog/proto-v0.50#activation-flow-now-triggers-immediately" class="hash-link" aria-label="Direct link to Activation flow now triggers immediately" title="Direct link to Activation flow now triggers immediately">​</a></h2>
<p>Our <a href="https://moonrepo.dev/docs/proto/workflows#shell-activation">activation flow</a> (shell hooks) is seeing more and more
usage, with improved stability, but based on feedback we've received, there was still some pain
points. One of these pain points was that activation would not trigger immediately (new terminal
window/tab), and would only trigger after changing directories.</p>
<p>There was a way around this using the <code>--on-init</code> flag, but that was not easily discoverable, and
the setup as a whole was not very intuitive. With this release, that flag has been deprecated and
the activation flow now triggers immediately, so you can start using your tools right away.</p>
<p>Historically we've been hesitent to do this, as we were worried about potential performance hits
when having to download WASM plugins, or refetch caches. However in practice this has not been an
issue.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="comments-are-now-preserved-in-prototools">Comments are now preserved in <code>.prototools</code><a href="https://moonrepo.dev/blog/proto-v0.50#comments-are-now-preserved-in-prototools" class="hash-link" aria-label="Direct link to comments-are-now-preserved-in-prototools" title="Direct link to comments-are-now-preserved-in-prototools">​</a></h2>
<p>This has been a long standing issue and a long requested feature, and it's finally here! Comments
are now preserved in <code>.prototools</code> files, and they'll no longer be removed when running <code>proto</code>
commands that modify these files (like <a href="https://moonrepo.dev/docs/proto/commands/alias"><code>proto alias</code></a> or
<a href="https://moonrepo.dev/docs/proto/commands/pin"><code>proto pin</code></a>).</p>
<p>Historically this has been a hard problem to solve, as Rust serde (serialization/deserialization
library) strips comments when deserializing (reading) the file. To solve this problem, we had to
avoid serde, and operate on an AST-like structure instead. Because of this, we lose type-safety and
there may be some edge cases not accounted for.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="plugin-commands-are-now-executed-within-a-shell">Plugin commands are now executed within a shell<a href="https://moonrepo.dev/blog/proto-v0.50#plugin-commands-are-now-executed-within-a-shell" class="hash-link" aria-label="Direct link to Plugin commands are now executed within a shell" title="Direct link to Plugin commands are now executed within a shell">​</a></h2>
<p>When a plugin executes a command (child process) on the host system (your computer), it now executes
it within a shell, e.g. <code>bash -c "command"</code>. This change was made to ensure environment variables
(like <code>PATH</code>), aliases, and other shell features that you have configured are available to the
plugin.</p>
<p>By default the shell to use is detected from the parent host process, but you can override it with
the <code>PROTO_SHELL</code> environment variable. For example, to use <code>zsh</code> you can set:</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token assign-left variable" style="color:#fef9c3">PROTO_SHELL</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token plain">zsh</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.50#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.50.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added <code>--dir</code> and <code>--all</code> options to the <a href="https://moonrepo.dev/docs/proto/commands/bin"><code>proto bin</code></a> command.</li>
<li>Added environment variable support to many non-tool related <code>.prototools</code> settings.</li>
<li>Updated <code>proto install &lt;tool&gt;</code> (without version) to install a version pinned in <code>.prototools</code>,
instead of the latest version.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="rewrite" term="rewrite"/>
        <category label="url" term="url"/>
        <category label="activation" term="activation"/>
        <category label="comments" term="comments"/>
        <category label="config" term="config"/>
        <category label="plugin" term="plugin"/>
        <category label="shell" term="shell"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.37 - Rust WASM toolchain and MCP support]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.37</id>
        <link href="https://moonrepo.dev/blog/moon-v1.37"/>
        <updated>2025-06-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we're stoked to release another WASM toolchain plugin, and experimental MCP/AI]]></summary>
        <content type="html"><![CDATA[<p>In this release, we're stoked to release another WASM toolchain plugin, and experimental MCP/AI
support!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="rfc-task-input-additions-and-enhancements">RFC: Task input additions and enhancements<a href="https://moonrepo.dev/blog/moon-v1.37#rfc-task-input-additions-and-enhancements" class="hash-link" aria-label="Direct link to RFC: Task input additions and enhancements" title="Direct link to RFC: Task input additions and enhancements">​</a></h2>
<p>We're planning to improve task inputs and have written up an
<a href="https://github.com/moonrepo/moon/issues/1985" target="_blank" rel="noopener noreferrer">RFC to discuss these changes</a>. We'd appreciate any
and all feedback!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-rust-toolchain-powered-by-wasm">New Rust toolchain powered by WASM<a href="https://moonrepo.dev/blog/moon-v1.37#new-rust-toolchain-powered-by-wasm" class="hash-link" aria-label="Direct link to New Rust toolchain powered by WASM" title="Direct link to New Rust toolchain powered by WASM">​</a></h2>
<p>With <a href="https://moonrepo.dev/blog/moon-v1.36">toolchain plugins</a> entering beta last release, it's only natural that we start
migrating the legacy toolchains into plugins. And with this release, the next one we've migrated is
the Rust toolchain! However, unlike the TypeScript toolchain, the new Rust toolchain is opt-in and
must be enabled. Simply rename <code>rust</code> to <code>unstable_rust</code> in <code>.moon/toolchain.yml</code>.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/toolchain.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">unstable_rust</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">version</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'1.87.0'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">components</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">'clippy'</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'rustfmt'</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">targets</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">'wasm32-wasip1'</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">syncToolchainConfig</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="new-functionality">New functionality<a href="https://moonrepo.dev/blog/moon-v1.37#new-functionality" class="hash-link" aria-label="Direct link to New functionality" title="Direct link to New functionality">​</a></h3>
<p>Although the new Rust toolchain is a one-to-one port, the WASM APIs provide far more flexibility and
functionality than before. For example, the follow improvements and enhancements have been made:</p>
<ul>
<li>The Cargo workspace can now exist at any folder depth and does not need to exist at the moon
workspace root. Additionally, because of this, we can now support multiple Cargo workspaces in the
same moon workspace.</li>
<li>Added a new <code>addMsrvConstraint</code> setting, which will sync the version as a constraint to
<code>Cargo.toml</code> under the <code>workspace.package.rust-version</code> or <code>package.rust-version</code> fields.</li>
<li>Improved the accuracy of implicit project dependencies (inferred from <code>Cargo.toml</code>).</li>
<li>Improved the parsing of manifest (<code>Cargo.toml</code>) and lock (<code>Cargo.lock</code>) files. This information is
then fed into the task hashing process.</li>
<li>Improved the Docker prune implementation by preserving all binaries (inferred from
<code>cargo metadata</code>) while deleting the <code>target</code> directory.</li>
<li>Any <code>cargo</code> or <code>rustup</code> commands are now hashed and cached, and will only re-run when parameters
change. Unlike the current toolchain, which always runs these commands.</li>
</ul>
<p>Quite a list of improvements, and this doesn't even include all the WASM / plugin improvements that
have been slowly introduced! Give this new toolchain a try, and let us know what you think!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="mcp-editor-integration">MCP editor integration<a href="https://moonrepo.dev/blog/moon-v1.37#mcp-editor-integration" class="hash-link" aria-label="Direct link to MCP editor integration" title="Direct link to MCP editor integration">​</a></h2>
<p>AI is all the rage these days, and even more so lately with the introduction of
<a href="https://modelcontextprotocol.io/" target="_blank" rel="noopener noreferrer">MCP</a> (model context protocol) and agentic workflows. MCP is a new
way for AI assistants to "understand" what's going on in your project without you having to explain
everything. It works by feeding structured information, like in the context of moon, projects,
tasks, and relationships, directly into AI models like GitHub Copilot or Cursor.</p>
<p>No more tedious explanations required! The AI can jump straight to helpful suggestions that actually
work in your codebase, saving you time, and making the whole experience much smoother, especially in
complex monorepos with lots of moving parts.</p>
<p>To support agentic workflows, we're introducing an experimental <a href="https://moonrepo.dev/docs/commands/mcp"><code>moon mcp</code></a>
command, that starts an MCP server, and can be <a href="https://moonrepo.dev/docs/guides/mcp">integrated into your editor</a>. For
example, VS Code:</p>
<div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.vscode/mcp.json</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"servers"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"moon"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"type"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"stdio"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"command"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"moon"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"args"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"mcp"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"env"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">        </span><span class="token property" style="color:#b7a9f9">"MOON_WORKSPACE_ROOT"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"${workspaceFolder}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="supported-tools">Supported tools<a href="https://moonrepo.dev/blog/moon-v1.37#supported-tools" class="hash-link" aria-label="Direct link to Supported tools" title="Direct link to Supported tools">​</a></h3>
<p>Our MCP server currently supports the following tools. We'll be adding more tools in the future, so
if you have any suggestions, please let us know!</p>
<ul>
<li><code>get_project</code> - Get a project and its tasks by <code>id</code>.</li>
<li><code>get_projects</code> - Get all projects.</li>
<li><code>get_task</code> - Get a task by <code>target</code>.</li>
<li><code>get_tasks</code> - Get all tasks.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.37#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.37.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added <code>environment.initializing</code> and <code>environment.initialized</code> webhook events.</li>
<li>Added <code>root</code> and <code>toolchain</code> fields to <code>dependencies.installing</code> and <code>dependencies.installed</code>
webhook events.</li>
<li>Updated proto to <a href="https://github.com/moonrepo/proto/releases/tag/v0.49.4" target="_blank" rel="noopener noreferrer">v0.49.4</a> (from 0.49.1).</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="whats-next">What's next?<a href="https://moonrepo.dev/blog/moon-v1.37#whats-next" class="hash-link" aria-label="Direct link to What's next?" title="Direct link to What's next?">​</a></h2>
<p>With toolchains plugins being stabilized more, we'd like to focus on some other areas.</p>
<ul>
<li>Better command line argument parsing/joining (especially for task <code>args</code>)</li>
<li>Better child process I/O piping</li>
<li>Terminal notifications</li>
<li>WASM toolchain documentation</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="looking-for-toolchain-contributors">Looking for toolchain contributors!<a href="https://moonrepo.dev/blog/moon-v1.37#looking-for-toolchain-contributors" class="hash-link" aria-label="Direct link to Looking for toolchain contributors!" title="Direct link to Looking for toolchain contributors!">​</a></h3>
<p>Now that the Rust toolchain has been ported to WASM, we'd like to start porting the other
toolchains, starting with Go and JavaScript (not Bun or Node.js), and also investigate supporting
toolchains for entirely new languages, like PHP and Ruby! If you're interested in contributing these
toolchains, please ping us in Discord!</p>
<p>The only requirements is that these toolchains must be written in Rust and must exist in the
<a href="https://github.com/moonrepo/plugins" target="_blank" rel="noopener noreferrer">moonrepo/plugins</a> repository!</p>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="toolchain" term="toolchain"/>
        <category label="wasm" term="wasm"/>
        <category label="plugin" term="plugin"/>
        <category label="rust" term="rust"/>
        <category label="mcp" term="mcp"/>
        <category label="ai" term="ai"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.36 - Toolchain plugins beta, optimized remote caching, and codegen improvements]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.36</id>
        <link href="https://moonrepo.dev/blog/moon-v1.36"/>
        <updated>2025-05-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we're very excited to fully release toolchain plugins!]]></summary>
        <content type="html"><![CDATA[<p>In this release, we're very excited to fully release toolchain plugins!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="beta-release-of-toolchain-wasm-plugins">Beta release of toolchain WASM plugins<a href="https://moonrepo.dev/blog/moon-v1.36#beta-release-of-toolchain-wasm-plugins" class="hash-link" aria-label="Direct link to Beta release of toolchain WASM plugins" title="Direct link to Beta release of toolchain WASM plugins">​</a></h2>
<p>Two months ago we announced <a href="https://moonrepo.dev/blog/moon-v1.33">alpha toolchain plugins</a> with support for tier 3, but not
tier 2. The reason for this was that tier 3 is powered by <a href="https://moonrepo.dev/docs/proto/wasm-plugin">proto APIs</a>,
which already existed! We simply hooked them up to moon. The bulk of the remaining plugin work was
tier 2 support, which we are excited to announce has been completed! The following APIs have been
implemented:</p>
<ul>
<li><code>extend_project_graph</code> - Extend projects with toolchain specific info.</li>
<li><code>extend_task_command</code> - Extend the command child process with parameters.</li>
<li><code>extend_task_script</code> - Extend the script child process with parameters.</li>
<li><code>locate_dependencies_root</code> - Locate the package dependencies workspace root.</li>
<li><code>parse_manifest</code> - Parse a manifest file to extract dependencies.</li>
<li><code>parse_lock</code> - Parse a lock file to extract resolved dependencies.</li>
</ul>
<p>And the following surface areas have been integrated with:</p>
<ul>
<li>In the project graph:<!-- -->
<ul>
<li>Extend projects with dependencies, tasks, and an alias.</li>
</ul>
</li>
<li>In the action pipeline:<!-- -->
<ul>
<li>Added <code>SetupEnvironment</code> action that executes the <code>setup_environment</code> API.</li>
<li>Added <code>InstallDependencies</code> action that executes the <code>install_dependencies</code> API.</li>
</ul>
</li>
<li>When running tasks:<!-- -->
<ul>
<li>Extend the command/script with additional parameters before executing.</li>
<li>Inject dependency and lock information into the hash.</li>
</ul>
</li>
<li>With Docker:<!-- -->
<ul>
<li>Updated <code>docker prune</code> to utilize the new WASM APIs for toolchain plugins.</li>
</ul>
</li>
</ul>
<p>As of this release, all 27 APIs have been implemented, and toolchain plugins are now available for
general use! However, they are still quite unstable, not fully tested, and the APIs may change
between releases, but you can start using them today if you're feeling adventurous!</p>
<p>With all this said, we do not have documentation yet. We plan to slowly work on this across the next
few releases. In the meantime, check out the following resources for more information:</p>
<ul>
<li><a href="https://docs.rs/moon_pdk/" target="_blank" rel="noopener noreferrer"><code>moon_pdk</code></a> - Rust plugin development kit.</li>
<li>Existing <a href="https://github.com/moonrepo/plugins/tree/master/toolchains" target="_blank" rel="noopener noreferrer">toolchain plugins</a>.</li>
<li>In development <a href="https://github.com/moonrepo/plugins/pull/48" target="_blank" rel="noopener noreferrer">Rust toolchain</a>.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="optimized-remote-caching">Optimized remote caching<a href="https://moonrepo.dev/blog/moon-v1.36#optimized-remote-caching" class="hash-link" aria-label="Direct link to Optimized remote caching" title="Direct link to Optimized remote caching">​</a></h2>
<p>Like the past few releases, we've made some improvements to the remote caching layer.</p>
<p>To start, we're adding a new
<a href="https://moonrepo.dev/docs/config/workspace#verifyintegrity"><code>unstable_remote.cache.verifyIntegrity</code></a> setting, that will
verify the digest (hash) of downloaded blobs to ensure they aren't corrupted or incomplete. We
currently check the file size, but this will also now check the content. This setting will slightly
degrade performance but ensure reliability.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">unstable_remote</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">cache</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">verifyIntegrity</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre></div></div>
<p>While we're on the topic of reliability, we're also introducing an implicit rollback mechanic that
will remove partially downloaded or incomplete blobs if hydration ever fails at some point. This
will also run between executions to ensure there are no stale artifacts lying around.</p>
<p>And lastly, we've parallelized the blob existence checks, reducing the amount of large requests for
heavy tasks, and reworked how we inherit <code>MOON_REMOTE_*</code> environment variables.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-code-generation">Improved code generation<a href="https://moonrepo.dev/blog/moon-v1.36#improved-code-generation" class="hash-link" aria-label="Direct link to Improved code generation" title="Direct link to Improved code generation">​</a></h2>
<p>It's been a while since we've added new features to code generation, but thanks to some great
requests from the community, we have 2 this release!</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="archive-urls">Archive URLs<a href="https://moonrepo.dev/blog/moon-v1.36#archive-urls" class="hash-link" aria-label="Direct link to Archive URLs" title="Direct link to Archive URLs">​</a></h3>
<p>The first is that <a href="https://moonrepo.dev/docs/guides/codegen#archive-urls">remote archives</a> (zip, tar, etc) can be used
as template locations. The archive will then be downloaded and unpacked into <code>~/.moon/templates</code>.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">generator</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">templates</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'https://domain.com/some/path/to/archive.zip'</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="array-and-object-types">Array and object types<a href="https://moonrepo.dev/blog/moon-v1.36#array-and-object-types" class="hash-link" aria-label="Direct link to Array and object types" title="Direct link to Array and object types">​</a></h3>
<p>The second is that we now support <code>array</code> and <code>object</code>
<a href="https://moonrepo.dev/docs/config/template#variables">variable types</a> in <code>template.yml</code>. The values within each of these
collections can be any JSON-compatible type.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">template.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">variables</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'array'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">prompt</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'Type?'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">default</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">'app'</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'lib'</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'object'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">prompt</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'Metadata?'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">default</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">internal</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre></div></div>
<p>These variables and their nested values can then be accessed within templates using dot or bracket
notation.</p>
<div class="language-twig codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-twig codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token delimiter punctuation" style="color:#cad4e2">{{</span><span class="token plain"> type</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token number" style="color:#94dded">0</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"> metadata</span><span class="token punctuation" style="color:#cad4e2">.</span><span class="token plain">internal </span><span class="token delimiter punctuation" style="color:#cad4e2">}}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.36#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.36.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added <code>--host</code> and <code>--port</code> options to <code>moon action-graph</code>, <code>moon task-graph</code>, and
<code>moon project-graph</code>.</li>
<li>Added <code>--stdin</code> option to <code>moon ci</code> and <code>moon run</code>, which will allow touched files to be passed
via stdin, instead of running VCS commands to determine them.</li>
<li>Removed the restriction around <code>moon.{yml,pkl}</code> not being allowed as a task input. However, will
not be included when using <code>**/*</code>.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="whats-next">What's next?<a href="https://moonrepo.dev/blog/moon-v1.36#whats-next" class="hash-link" aria-label="Direct link to What's next?" title="Direct link to What's next?">​</a></h2>
<p>Now that toolchain plugins are in beta, we can take the next step in migrating an existing platform
into a toolchain.</p>
<ul>
<li>Migrate the Rust toolchain to a WASM plugin.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="toolchain" term="toolchain"/>
        <category label="wasm" term="wasm"/>
        <category label="plugin" term="plugin"/>
        <category label="remote" term="remote"/>
        <category label="cache" term="cache"/>
        <category label="integrity" term="integrity"/>
        <category label="codegen" term="codegen"/>
        <category label="template" term="template"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.35 - Action graph improvements, task priorities, and more!]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.35</id>
        <link href="https://moonrepo.dev/blog/moon-v1.35"/>
        <updated>2025-04-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[With this release, we're taking yet another step to supporting plugins.]]></summary>
        <content type="html"><![CDATA[<p>With this release, we're taking yet another step to supporting plugins.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-action-graph">Improved action graph<a href="https://moonrepo.dev/blog/moon-v1.35#improved-action-graph" class="hash-link" aria-label="Direct link to Improved action graph" title="Direct link to Improved action graph">​</a></h2>
<p>For this release we wanted to introduce a new WASM based Rust toolchain, but we encountered a few
blockers while integrating with the action graph, so instead of working on the toolchain, we decided
to rewrite the action graph to properly support plugins.</p>
<p>The biggest blocker was around locating the toolchain's dependency root, and in Rust's case, the
Cargo workspace (where <code>Cargo.lock</code> is located). We technically have some of this logic in the
current Rust platform, but it always assumed that the Cargo workspace was in the root of the moon
workspace (the same applies to Bun and Node). This heavily restricted all moon users. With the new
plugin system, the dependency root can be located anywhere in the moon workspace, and we'll attempt
to locate it!</p>
<p>While rewriting the action graph, we made a ton of improvements (some won't be noticeable until
plugins are more prevalent). To start the graph is now async compatible, and in the future, we'll
update it to also support concurrency, so that the graph can be built in parallel across threads.
Additionally, a main focus was reducing the amount of edges (relationships) being created between
nodes (actions). And lastly, the following changes were made for the actions themselves.</p>
<ul>
<li>Added a new <code>InstallDependencies</code> action for WASM plugins.<!-- -->
<ul>
<li>The dependencies root is now dynamically located by traversing the file system, unlike the
previous implementation that assumed everything was in the workspace root.</li>
</ul>
</li>
<li>Added a new <code>SetupEnvironment</code> action for WASM plugins.<!-- -->
<ul>
<li>This runs after <code>SetupToolchain</code> but before <code>InstallDependencies</code>.</li>
<li>Can be used to setup the workspace or project environment. For example, initializing Python
venv, or making manifest/lockfile changes.</li>
</ul>
</li>
<li>Updated <code>RunTask</code> to setup toolchains and install dependencies for each <code>toolchain</code> that has been
configured, instead of just the 1st one (work in progress).</li>
<li>Updated <code>SyncProject</code> to no longer depend on <code>SetupToolchain</code>, and not be grouped by
language/toolchain, and instead encompass all of them applicable to the project.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="task-priorities">Task priorities<a href="https://moonrepo.dev/blog/moon-v1.35#task-priorities" class="hash-link" aria-label="Direct link to Task priorities" title="Direct link to Task priorities">​</a></h2>
<p>Based on a request from the community that we really liked, we're introducing a new concept called
task priorities. Each task can configure a priority level using the new task option
<a href="https://moonrepo.dev/docs/config/project#priority"><code>priority</code></a>, and the priority level determines the position of the
task within the action pipeline queue. A task with a higher priority will run sooner rather than
later, while still respecting the topological order.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">app/moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">priority</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'high'</span><br></span></code></pre></div></div>
<p>There are a few things to be aware of with this implementation:</p>
<ul>
<li>All non-task related actions (like setup toolchain) will still always run first.</li>
<li>Higher priority tasks that depend on lower priority tasks will effectively mark them as high
priority, as we attempt to complete them sooner.</li>
<li>The order within each priority level is sorted topological, but is still non-deterministic if
tasks run in parallel.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="enabled-experiments">Enabled experiments<a href="https://moonrepo.dev/blog/moon-v1.35#enabled-experiments" class="hash-link" aria-label="Direct link to Enabled experiments" title="Direct link to Enabled experiments">​</a></h2>
<p>In our last release, we introduced <a href="https://moonrepo.dev/blog/moon-v1.34#new-experiments">2 new experiments</a>,
<code>fasterGlobWalk</code> and <code>gitV2</code>. In the past few weeks, we've had many users (including ourself) enable
these experiments without issue. As such, we've decided to enable them by default in this release.</p>
<p>If you encounter an issue with either of these experiments, you can disable them in
<code>.moon/workspace.yml</code>. And of course, please report it so we can fix it!</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">experiments</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">fasterGlobWalk</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">gitV2</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="light-terminal-theme">Light terminal theme<a href="https://moonrepo.dev/blog/moon-v1.35#light-terminal-theme" class="hash-link" aria-label="Direct link to Light terminal theme" title="Direct link to Light terminal theme">​</a></h2>
<p>By default, moon assumes a dark themed terminal is being used, and will output our branded colors
accordingly. However, if you use a light theme, these colors are hard to read, and there's no way to
change them.</p>
<p>To mitigate this, we're introducing a light based terminal theme, which can be enabled with the
<code>--theme</code> global option, or the <code>MOON_THEME</code> environment variable.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon run app:build </span><span class="token parameter variable" style="color:#fef9c3">--theme</span><span class="token plain"> light</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ </span><span class="token assign-left variable" style="color:#fef9c3">MOON_THEME</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token plain">light moon run app:build</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.35#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.35.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added a new task option, <code>cacheKey</code>, which can be used to seed the hash, and invalidate local and
remote caches.</li>
<li>Added a <code>--log=verbose</code> level, which includes span information on top of the trace level.</li>
<li>Added 2 new webhooks, <code>toolchain.installing</code> and <code>toolchain.installed</code>, which emit when a
toolchain WASM plugin is installing a tool (via proto).</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="whats-next">What's next?<a href="https://moonrepo.dev/blog/moon-v1.35#whats-next" class="hash-link" aria-label="Direct link to What's next?" title="Direct link to What's next?">​</a></h2>
<p>Now that are action graph supports plugins, we can take the next step in migrating an existing
platform into a toolchain.</p>
<ul>
<li>Migrate the Rust toolchain to a WASM plugin.</li>
<li>Investigate a new args/command line parser.</li>
<li>Add Poetry support for the Python toolchain.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="action" term="action"/>
        <category label="graph" term="graph"/>
        <category label="task" term="task"/>
        <category label="priority" term="priority"/>
        <category label="experiment" term="experiment"/>
        <category label="terminal" term="terminal"/>
        <category label="theme" term="theme"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.34 - Action customization, faster globs, better Git, and more!]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.34</id>
        <link href="https://moonrepo.dev/blog/moon-v1.34"/>
        <updated>2025-03-31T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[With this release, we're introducing a handful of performance and customization improvements!]]></summary>
        <content type="html"><![CDATA[<p>With this release, we're introducing a handful of performance and customization improvements!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="moonbase-has-been-sunset">moonbase has been sunset<a href="https://moonrepo.dev/blog/moon-v1.34#moonbase-has-been-sunset" class="hash-link" aria-label="Direct link to moonbase has been sunset" title="Direct link to moonbase has been sunset">​</a></h2>
<p>As mentioned in previous releases, we have sunset <a href="https://moonrepo.dev/moonbase">moonbase</a>, our remote caching service.
A while back we had internal discussions on whether to rework moonbase so that it could be
self-hosted (on-premises), or adopt the
<a href="https://github.com/bazelbuild/remote-apis" target="_blank" rel="noopener noreferrer">Bazel Remote Execution API</a> and utilize what the open
source community has to offer. We ultimately decided with the latter, as it frees up resources on
our end to focus on moon and proto, and also provides a better path forward for moon adoption.</p>
<p>If you are currently using moonbase, we suggest migrating to our new
<a href="https://moonrepo.dev/docs/guides/remote-cache">remote caching options</a>. And if you have an active moonbase
subscription, it will be cancelled within the week, and any partial billing for this month will be
prorated.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="customize-actions-in-the-pipeline">Customize actions in the pipeline<a href="https://moonrepo.dev/blog/moon-v1.34#customize-actions-in-the-pipeline" class="hash-link" aria-label="Direct link to Customize actions in the pipeline" title="Direct link to Customize actions in the pipeline">​</a></h2>
<p>When a task is ran in moon, we create an <a href="https://moonrepo.dev/docs/how-it-works/action-graph">action graph</a> (not a task
graph) of actions, which are operations required to run to ensure a successful execution. This
includes non-task related functionality, like project and workspace syncing, installing
dependencies, and ensuring the toolchain has been setup. While these actions only take milliseconds
to execute (on a cache hit), they can become quite a barrier and source of friction (on cache miss).</p>
<p>Until now, there wasn't anyway to disable/skip these extra actions -- besides some non-documented
environment variables that didn't actually omit the actions (they were still in the graph), but
simply skipped the inner execution. In this release, we're introducing 4 new settings for
<a href="https://moonrepo.dev/docs/config/workspace#pipeline"><code>pipeline</code></a> (formerly <code>runner</code>) in
<a href="https://moonrepo.dev/docs/config/workspace"><code>.moon/workspace.yml</code></a>.</p>
<ul>
<li><code>installDependencies</code> setting toggles the inclusion of the <code>InstallWorkspaceDeps</code> and
<code>InstallProjectDeps</code> actions, and can be scoped to toolchain IDs.</li>
<li><code>syncProjects</code> setting toggles the inclusion of the <code>SyncProject</code> actions, and can be scoped to
project IDs.</li>
<li><code>syncProjectDependencies</code> setting toggles whether to recursively create <code>SyncProject</code> actions for
each dependency of a project, or just for itself.</li>
<li><code>syncWorkspace</code> setting toggles the inclusion of the root <code>SyncWorkspace</code> action.</li>
</ul>
<p>For example, if you want to disable all of these actions entirely, you can do this:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">pipeline</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">installDependencies</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">syncProjects</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">syncProjectDependencies</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">syncWorkspace</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><br></span></code></pre></div></div>
<p>And as mentioned above, the <code>installDependencies</code> and <code>syncProjects</code> settings support configuring a
list of IDs, which acts as an allow list. Any IDs not listed here will not create actions.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">pipeline</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token comment" style="color:#97a1af;font-style:italic"># Only install Node.js dependencies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">installDependencies</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">'node'</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token comment" style="color:#97a1af;font-style:italic"># Only sync the `app` project</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">syncProjects</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">'app'</span><span class="token punctuation" style="color:#cad4e2">]</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>Even if you disable actions with the <code>pipeline</code> setting, the <a href="https://moonrepo.dev/docs/commands/sync"><code>moon sync</code></a>
commands can still be used to run sync operations, as they ignore that setting. This provides a
solution where you want to avoid the overhead when running a task, but still take advantage of
moon's syncing to ensure a healthy repository state.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="new---no-actions-flag">New <code>--no-actions</code> flag<a href="https://moonrepo.dev/blog/moon-v1.34#new---no-actions-flag" class="hash-link" aria-label="Direct link to new---no-actions-flag" title="Direct link to new---no-actions-flag">​</a></h3>
<p>To expand upon the above, we're introducing a <code>--no-actions</code> flag to
<a href="https://moonrepo.dev/docs/commands/run"><code>moon run</code></a>, that will run the task without the other actions being added to
the graph. We suggest only using this flag once dependencies have been installed, and the toolchain
has been setup!</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon run app:start --no-actions</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-experiments">New experiments<a href="https://moonrepo.dev/blog/moon-v1.34#new-experiments" class="hash-link" aria-label="Direct link to New experiments" title="Direct link to New experiments">​</a></h2>
<p>It's been a while since we've added new experiments, and in this release, we've got 2! We encourage
everyone to enable these experiments to ensure they are working correctly, but do note that these
are a work in progress and may be buggy.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="faster-glob-walking">Faster glob walking<a href="https://moonrepo.dev/blog/moon-v1.34#faster-glob-walking" class="hash-link" aria-label="Direct link to Faster glob walking" title="Direct link to Faster glob walking">​</a></h3>
<p>We've been monitoring glob performance for sometime now, as walking the filesystem has been one of
the largest bottlenecks, especially in large codebases. We felt it was about time to tackle the
problem.</p>
<p>With this new implementation, we are doing a few things to increase performance. To start, we are
parallelizing walking per directory, where previously this would happen serially. Next, we partition
globs based on a common ancestor directory, which reduces the amount of unnecessary walking. And
lastly, we cache common globs to avoid walking all together.</p>
<p>In our benchmarks and tests (moon itself is already using it), we are seeing performance increases
by 1.5-2x! To start using this new glob implementation, enable the new <code>fasterGlobWalk</code> experiment.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">experiments</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">fasterGlobWalk</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="better-git-integration">Better Git integration<a href="https://moonrepo.dev/blog/moon-v1.34#better-git-integration" class="hash-link" aria-label="Direct link to Better Git integration" title="Direct link to Better Git integration">​</a></h3>
<p>Our current Git integration works, assuming you're not doing anything complex, like using submodules
or worktrees. If you are using the latter, things have been buggy. We're not happy about this, as we
want to support all the different ways a repository can be architected.</p>
<p>So we started over from scratch! We even created
<a href="https://github.com/moonrepo/git-test" target="_blank" rel="noopener noreferrer">real repositories</a> to ensure our understanding and
implementation of these features is accurate. This new implementation achieves the following:</p>
<ul>
<li>Supports submodules, subtrees, and worktees (unique among build systems).<!-- -->
<ul>
<li>Our competitors don't support these, and we expect them to "borrow" our implementation in the
future (like they have with other features).</li>
</ul>
</li>
<li>Git commands are parallelized when applicable.</li>
<li>Touched files within submodules are now properly extracted.</li>
<li>File discovery and hashing is more performant.</li>
</ul>
<p>If you'd like to try this new Git implementation (moon itself already is), enable the <code>gitV2</code>
experiment.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">experiments</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">gitV2</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.34#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.34.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added a <code>--json</code> flag to <code>moon templates</code>.</li>
<li>Integrated a new console rendering system with new terminal styles, prompts, and output.</li>
<li>Improved the performance of environment variable substitution.</li>
<li>Improved toolchain plugin loading to be on-demand.</li>
<li>Improved sync cache invalidation for codeowners, config schemas, and VCS hooks.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="whats-next">What's next?<a href="https://moonrepo.dev/blog/moon-v1.34#whats-next" class="hash-link" aria-label="Direct link to What's next?" title="Direct link to What's next?">​</a></h2>
<p>Going forward, we plan to release new updates on a bi-weekly schedule, instead of a monthly
schedule. This will result in less features each release, but will reduce the burden and complexity
of large releases. With that said, this is what we have tentatively planned for the next release!</p>
<ul>
<li>Migrate the Rust toolchain to a WASM plugin.</li>
<li>Investigate a new args/command line parser.</li>
<li>Add Poetry support for the Python toolchain.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="moonbase" term="moonbase"/>
        <category label="remote" term="remote"/>
        <category label="cache" term="cache"/>
        <category label="action" term="action"/>
        <category label="pipeline" term="pipeline"/>
        <category label="glob" term="glob"/>
        <category label="git" term="git"/>
        <category label="experiment" term="experiment"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moonbase has been sunset]]></title>
        <id>https://moonrepo.dev/blog/moonbase-sunset</id>
        <link href="https://moonrepo.dev/blog/moonbase-sunset"/>
        <updated>2025-03-31T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[As mentioned in previous moon releases and announcements, we have sunset moonbase, our]]></summary>
        <content type="html"><![CDATA[<p>As mentioned in previous moon releases and announcements, we have sunset <a href="https://moonrepo.dev/moonbase">moonbase</a>, our
remote caching service.</p>
<p>A while back we had internal discussions on whether to rework moonbase so that it could be
self-hosted (on-premises), or adopt the
<a href="https://github.com/bazelbuild/remote-apis" target="_blank" rel="noopener noreferrer">Bazel Remote Execution API</a> and utilize what the open
source community has to offer. We ultimately decided with the latter, as it frees up resources on
our end to focus on moon and proto, and also provides a better path forward for moon adoption.</p>
<p>If you are currently using moonbase, we suggest migrating to our new
<a href="https://moonrepo.dev/docs/guides/remote-cache">remote caching options</a>. And if you have an active moonbase
subscription, it will be cancelled within the week, and any partial billing for this month will be
prorated.</p>
<p>With that said, we have some ideas brewing on how to bring this back in another form. Perhaps our
own implementation of the Bazel Remote Execution API that can be self-hosted and deeply integrate
with moon.</p>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="moonbase" term="moonbase"/>
        <category label="remote" term="remote"/>
        <category label="cache" term="cache"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.33 - Alpha support for toolchain WASM plugins]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.33</id>
        <link href="https://moonrepo.dev/blog/moon-v1.33"/>
        <updated>2025-03-13T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[With this release, we're stoked to provide an initial release for plugin support.]]></summary>
        <content type="html"><![CDATA[<p>With this release, we're stoked to provide an initial release for plugin support.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="alpha-release-of-toolchain-wasm-plugins">Alpha release of toolchain WASM plugins<a href="https://moonrepo.dev/blog/moon-v1.33#alpha-release-of-toolchain-wasm-plugins" class="hash-link" aria-label="Direct link to Alpha release of toolchain WASM plugins" title="Direct link to Alpha release of toolchain WASM plugins">​</a></h2>
<p>For over a <a href="https://moonrepo.dev/blog/2024-roadmap#plugin-based-architecture">year now</a>, we've talked about supporting
WASM-based toolchain plugins... but what's taking so long? Migrating from a "hard-coded in core"
approach to a dynamic plugin approach was actually quite difficult, especially in Rust. It took us
way longer than we expected.</p>
<p>With that said, we're excited to announce alpha support for WASM-based toolchain plugins. In this
release, we have a working solution, but with partial support for the toolchain's
<a href="https://moonrepo.dev/docs/how-it-works/languages#tier-structure-and-responsibilities">tiered features</a>. At this point
in time, we provide full support for tier 0, major support for tier 1 excluding lockfile/manifest
parsing, minor support for tier 2, no support for tier 3 (but will use
<a href="https://moonrepo.dev/docs/proto/wasm-plugin">proto's APIs</a>), and support for non-tiered features, like
<a href="https://moonrepo.dev/docs/commands/init"><code>moon init</code></a> and <a href="https://moonrepo.dev/docs/commands/docker"><code>moon docker</code></a>.</p>
<p>If you're curious, the following WASM function APIs are now available:</p>
<ul>
<li><code>register_toolchain</code> - Registers the toolchain and provide metadata for detection and other
purposes.</li>
<li><code>initialize_toolchain</code> - Provides prompts to use during <code>moon init</code> to gather settings values.</li>
<li><code>define_toolchain_config</code> - Defines a configuration schema for use within JSON schemas.</li>
<li><code>define_docker_metadata</code> - Defines metadata related to <code>docker</code> commands.</li>
<li><code>hash_task_contents</code> - Injects content into the task hashing process.</li>
<li><code>prune_docker</code> - Custom operations to run during <code>docker prune</code>.</li>
<li><code>scaffold_docker</code> - Custom operations to run during <code>docker scaffold</code>.</li>
<li><code>sync_project</code> - Runs syncing operations per project (during the <code>SyncProject</code> action).</li>
<li><code>sync_workspace</code> - Runs syncing operations at the workspace root (during the <code>SyncWorkspace</code>
action).</li>
</ul>
<p>We know everyone is very excited about these plugins, so feel free to start using them today!
However, since we don't have full tiered support, most of the advanced functionality related to
running tasks is currently not supported (except for task hashing which is supported).</p>
<p>Additionally, we do <em>not</em> have documentation yet for these new APIs, but we do have the following
resources to help you get started:</p>
<ul>
<li><a href="https://moonrepo.dev/docs/guides/wasm-plugins">Getting started with WASM plugins</a></li>
<li><a href="https://github.com/moonrepo/plugins/tree/master/toolchains" target="_blank" rel="noopener noreferrer">Example toolchain WASM plugins</a></li>
<li><a href="https://docs.rs/moon_pdk" target="_blank" rel="noopener noreferrer"><code>moon_pdk</code> documentation</a> (functions, macros, etc)</li>
<li><a href="https://docs.rs/moon_pdk_api" target="_blank" rel="noopener noreferrer"><code>moon_pdk_api</code> documentation</a> (structs, enums, etc)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="typescript-toolchain">TypeScript toolchain<a href="https://moonrepo.dev/blog/moon-v1.33#typescript-toolchain" class="hash-link" aria-label="Direct link to TypeScript toolchain" title="Direct link to TypeScript toolchain">​</a></h3>
<p>To verify that our WASM plugin implementation works correctly, we've
<a href="https://github.com/moonrepo/plugins/tree/master/toolchains/typescript" target="_blank" rel="noopener noreferrer">migrated the TypeScript toolchain entirely to a WASM plugin</a>,
and it's no longer hard-coded in our Rust core! If you've configured
<a href="https://moonrepo.dev/docs/config/toolchain#typescript"><code>typescript</code></a> in
<a href="https://moonrepo.dev/docs/config/toolchain"><code>.moon/toolchain.yml</code></a>, then you'll automatically use the new plugin under
the hood.</p>
<p>This is our first step in supporting plugins in core. We chose TypeScript as our 1st plugin because
it was the simplest of all the toolchains, was primarily used for project syncing, and did not
require all tiered APIs.</p>
<p>With that said, most of the code had to be rewritten when porting, but we tried to keep as much
parity as possible. Please report an issues or differences you encounter. Additionally, because
TypeScript is now a "true" toolchain, it will appear in the toolchains list for projects and tasks.
This is required since it runs operations in the context of the plugin.</p>
<p>Because toolchain plugins are configured differently internally, and since TypeScript is now a
plugin, the configuration syntax for disabling the TypeScript toolchain at the project-level has
changed. While not a breaking change in this release, the old format will be removed in the future.</p>
<div class="language-yml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># Before</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">toolchain</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">typescript</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">disable</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># After</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">toolchain</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">typescript</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><span class="token plain"> </span><span class="token comment" style="color:#97a1af;font-style:italic"># or null</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-warning admonition_WCGJ alert alert--warning"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_pbrs"><p>If you use the TypeScript toolchain, you'll need to update your configuration files or editor to
point to the newer <a href="https://moonrepo.dev/blog/moon-v1.33#dynamic-json-schemas">JSON schemas</a>, otherwise your editor may error with
"Property typescript is not allowed".</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="experimental-moonx-executable">Experimental <code>moonx</code> executable<a href="https://moonrepo.dev/blog/moon-v1.33#experimental-moonx-executable" class="hash-link" aria-label="Direct link to experimental-moonx-executable" title="Direct link to experimental-moonx-executable">​</a></h2>
<p>Based on a <a href="https://github.com/moonrepo/moon/issues/1828" target="_blank" rel="noopener noreferrer">request from the community</a>, we're
introducing a new executable <code>moonx</code>, which is simply a shorthand for <code>moon run ...</code>. In the future
we will expand this with more "shorthand" functionality.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moonx app:build</span><br></span></code></pre></div></div>
<p>Because of our current release process, the <code>moonx</code> executable is <em>not</em> packaged in the release (on
GitHub), and is instead created the first time <code>moon</code> runs. Furthermore, <code>moonx</code> is not a binary
executable, and is instead a shim (a Bash script on Unix, and a PowerShell (<code>.ps1</code>) script on
Windows). In the future, this will become a true binary.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="dynamic-json-schemas">Dynamic JSON schemas<a href="https://moonrepo.dev/blog/moon-v1.33#dynamic-json-schemas" class="hash-link" aria-label="Direct link to Dynamic JSON schemas" title="Direct link to Dynamic JSON schemas">​</a></h2>
<p>With the initial support for toolchain plugins, the available configuration in
<a href="https://moonrepo.dev/docs/config/toolchain"><code>.moon/toolchain.yml</code></a> and <a href="https://moonrepo.dev/docs/config/project"><code>moon.yml</code></a> is no longer
static, and is instead dynamic based on the enabled/configured toolchains. Because of this, the JSON
schemas provided at <code>moonrepo.dev</code> and in the GitHub release are not accurate for some toolchain
related settings, but accurate for everything else.</p>
<p>This may lead to a poor developer experience where your editor shows errors for unknown settings. To
remedy this, we now generate dynamic schemas at <code>.moon/cache/schemas</code> with accurate settings. If
you're editor supports the <code>$schema</code> property, you can update them like so:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/toolchain.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">$schema</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'./cache/schemas/toolchain.json'</span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">app/moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">$schema</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'../.moon/cache/schemas/toolchain.json'</span><br></span></code></pre></div></div>
<p>The VS Code YAML server does not support the
<a href="https://github.com/redhat-developer/yaml-language-server/pull/970" target="_blank" rel="noopener noreferrer"><code>$schema</code> property</a>, but there
is a
<a href="https://github.com/redhat-developer/yaml-language-server?tab=readme-ov-file#using-inlined-schema" target="_blank" rel="noopener noreferrer">work around</a>.
However, that syntax is a bit unfortunate, so our official moon VS Code extension supports updating
<code>.vscode/settings</code>. Simply open the command palette and select "moon: Append YAML schemas
configuration to settings".</p>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>These schemas are automatically generated through <a href="https://moonrepo.dev/docs/commands/run"><code>moon run</code></a> but can be
manually generated with <a href="https://moonrepo.dev/docs/commands/sync/config-schemas"><code>moon sync config-schemas</code></a>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.33#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.33.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added support for <code>moon run ~:build</code>, which will run the <code>build</code> task in the closest project
(traversing upwards).</li>
<li>Added <code>$XDG_DATA_HOME</code> support when detecting the moon store. Will be used if <code>$MOON_HOME</code> is not
set, and will fallback to <code>$HOME/.moon</code>.</li>
<li>Added elapsed/timing information to child processes and WASM calls within logs.</li>
<li>Improved the handling of CTRL-C, CTRL-BREAK, and other signals on Windows.</li>
<li>Updated <code>moon init</code> with toolchain plugin support.</li>
<li>Updated <code>toolchain.default</code> in <code>moon.yml</code> to support a list of IDs.</li>
<li>Updated file hashing (via <code>git hash-object</code>) to continously pipe stdin to avoid hanging processes.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="toolchain" term="toolchain"/>
        <category label="wasm" term="wasm"/>
        <category label="plugin" term="plugin"/>
        <category label="moonx" term="moonx"/>
        <category label="schema" term="schema"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.47 - New backend system & asdf support]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.47</id>
        <link href="https://moonrepo.dev/blog/proto-v0.47"/>
        <updated>2025-02-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we're stoked to release backends, a new type of plugin that enables the use of]]></summary>
        <content type="html"><![CDATA[<p>In this release, we're stoked to release backends, a new type of plugin that enables the use of
3rd-party plugins.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-backend-asdf">New backend: <code>asdf</code><a href="https://moonrepo.dev/blog/proto-v0.47#new-backend-asdf" class="hash-link" aria-label="Direct link to new-backend-asdf" title="Direct link to new-backend-asdf">​</a></h2>
<p>Since proto's inception, we've been asked the question "how's this different than asdf?", or "why
not just use asdf?". The answer to both of these questions is still the same 3 things:</p>
<ul>
<li>To start, asdf isn't multi-platform, it's Unix only and doesn't support Windows (proto does).</li>
<li>Secondly, asdf is powered by Bash scripts, which means a bash-compatible interpreter or shell is
required (proto uses WASM).</li>
<li>And lastly, proto is built on Rust, so it's extremely fast and reliable.</li>
</ul>
<p>With all that said, asdf has a massive <a href="https://github.com/asdf-vm/asdf-plugins" target="_blank" rel="noopener noreferrer">plugin registry</a>
compared to proto's, and it would take a really long time for proto to reach parity. Because of
this, we've been working on a new plugin type called a "<a href="https://moonrepo.dev/docs/proto/tool-spec#backends">backend</a>",
which allows 3rd-party plugins to be utilized within proto for downloading and installing tools,
locating executables, and more.</p>
<p>Of course, our first backend is <a href="https://asdf-vm.com/" target="_blank" rel="noopener noreferrer">asdf</a>. To install a tool from asdf's
registry, prefix the version in <code>.prototools</code> with <a href="https://moonrepo.dev/docs/proto/tool-spec#backends"><code>asdf:</code></a>, or
configure the <a href="https://moonrepo.dev/docs/proto/config#backend"><code>backend</code></a> setting.</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.prototools</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># For this single version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">zig</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"asdf:0.13.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># For all versions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">zig</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"0.13.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">tools.zig</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">backend</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"asdf"</span><br></span></code></pre></div></div>
<p>This backend implementation <em>does not</em> use the <code>asdf</code> binary itself, and instead emulates the
environment as best we can. Because of this, some tools may not be usable through proto, especially
those that rely on <code>asdf</code> itself. Furthermore, the 2 bullet points above are unfortunately still
restrictions: This is Unix only and requires Bash.</p>
<blockquote>
<p>In the next release, we'll investigate the use of Scoop or Chocolatey as a potential backend for
Windows users. If you're interested in this endeavor, send us a message in Discord!</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-built-in-tool-poetry">New built-in tool: <code>poetry</code><a href="https://moonrepo.dev/blog/proto-v0.47#new-built-in-tool-poetry" class="hash-link" aria-label="Direct link to new-built-in-tool-poetry" title="Direct link to new-built-in-tool-poetry">​</a></h2>
<p>In <a href="https://moonrepo.dev/blog/proto-v0.45">v0.45</a> we introduced 3 new tools, and in this release, we're releasing 1 more! We
want to expand our Python support, and since we already support pip and uv, we wanted to also
support Poetry, which has been requested by the community many times now. Poetry installation works
quite differently than other tools, so please report any issues or improvements.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> poetry</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="proto-now-shims-itself">proto now shims itself<a href="https://moonrepo.dev/blog/proto-v0.47#proto-now-shims-itself" class="hash-link" aria-label="Direct link to proto now shims itself" title="Direct link to proto now shims itself">​</a></h2>
<p>Until now, proto was a stand-alone binary that existed on <code>PATH</code> and was not coupled to proto's
store (<code>~/.proto</code>) outside of possibly existing in <code>~/.proto/bin</code> for convenience. Over the past
couple of releases, we've been working on supporting proto as an
<a href="https://github.com/moonrepo/plugins/tree/master/tools/proto" target="_blank" rel="noopener noreferrer">official tool</a> within proto, so
commands like <code>proto install proto</code> and <code>proto pin proto 0.45</code> actually function correctly.</p>
<p>Starting in this release, when proto is installed via proto, either through <code>proto install</code> or
<code>proto upgrade</code>, a shim will be created at <code>~/.proto/shims/proto</code>, allowing for runtime version
detection and pinning. This basically means you can now pin a project to a certain version of proto
like any other tool, for example:</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.prototools</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key property" style="color:#b7a9f9">proto</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"0.46"</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.47#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.47.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Updated offline connection checks to also ping IPv6 addresses for Google &amp; CloudFlare DNS.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="backend" term="backend"/>
        <category label="plugin" term="plugin"/>
        <category label="asdf" term="asdf"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.32 - Remote cache and built-in toolchain improvements]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.32</id>
        <link href="https://moonrepo.dev/blog/moon-v1.32"/>
        <updated>2025-02-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release we focused primarily on remote caching and toolchain improvements.]]></summary>
        <content type="html"><![CDATA[<p>In this release we focused primarily on remote caching and toolchain improvements.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-remote-caching-stability">Improved remote caching stability<a href="https://moonrepo.dev/blog/moon-v1.32#improved-remote-caching-stability" class="hash-link" aria-label="Direct link to Improved remote caching stability" title="Direct link to Improved remote caching stability">​</a></h2>
<p>The main focus of this release was the stability of our remote caching implementation, by fixing all
bugs and edge cases, and adding support for missing or new features.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="new-settings">New settings<a href="https://moonrepo.dev/blog/moon-v1.32#new-settings" class="hash-link" aria-label="Direct link to New settings" title="Direct link to New settings">​</a></h3>
<p>To support new features (below), we are introducing 2 new settings,
<a href="https://moonrepo.dev/docs/config/workspace#api"><code>unstable_remote.api</code></a> and
<a href="https://moonrepo.dev/docs/config/workspace#auth"><code>unstable_remote.auth</code></a>. The <code>api</code> setting defines what API format the
remote server supports and expects client requests to be sent in, either <code>grpc</code> (default) or <code>http</code>.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">unstable_remote</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">api</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'grpc'</span><br></span></code></pre></div></div>
<p>While the <code>auth</code> setting does 2 things; allows HTTP headers to be configured that will be injected
into all gRPC/HTTP requests, and a token (via environment variable) to be used for bearer
authorization (instead of TLS/mTLS).</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">unstable_remote</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">auth</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">headers</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">'X-Custom-Header'</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'value'</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="http-api-support">HTTP API support<a href="https://moonrepo.dev/blog/moon-v1.32#http-api-support" class="hash-link" aria-label="Direct link to HTTP API support" title="Direct link to HTTP API support">​</a></h3>
<p>If you don't want or can't use gRPC, we now support the
<a href="https://bazel.build/remote/caching#http-caching" target="_blank" rel="noopener noreferrer">HTTP caching protocol</a>. This is a very simple API
that uploads action results to <code>/ac/</code> endpoints, and output blobs to <code>/cas/</code> endpoints (content
addressable storage). The HTTP API is <em>very</em> simple and does not support any of the features
provided by gRPC, like batch uploading/downloading, streaming, or missing blob detection.</p>
<p>To use this protocol, set the new <code>api</code> setting to <code>http</code>, and configure an HTTP host.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">unstable_remote</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">api</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'http'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">host</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'https://cache.yourhost.com'</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="bytestream-support">ByteStream support<a href="https://moonrepo.dev/blog/moon-v1.32#bytestream-support" class="hash-link" aria-label="Direct link to ByteStream support" title="Direct link to ByteStream support">​</a></h3>
<p>We now support the ByteStream API for gRPC servers, which will automatically download and upload
blobs larger than 4mb by streaming chunks of data. Previously, if we encountered a blob larger than
4mb, we would abort uploading to the cache for that action, so subseqeuent runs would always be a
cache miss.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="depot-cloud-hosting">Depot cloud hosting<a href="https://moonrepo.dev/blog/moon-v1.32#depot-cloud-hosting" class="hash-link" aria-label="Direct link to Depot cloud hosting" title="Direct link to Depot cloud hosting">​</a></h3>
<p>Our good friends at Depot (<a href="https://depot.dev/" target="_blank" rel="noopener noreferrer">depot.dev</a>) recently announced
<a href="https://depot.dev/blog/introducing-depot-cache" target="_blank" rel="noopener noreferrer">Depot Cache</a>, a cloud-based caching solution that's
compatible with the Bazel remote execution/caching API. We were very excited to read this
announcement, and wanted to get it working in moon immediately. It took a bit of work, and uncovered
a lot of bugs on our end, but we eventually got it working!</p>
<p>To make use of Depot Cache, create an account on their end, and then configure moon with the
following.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">unstable_remote</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">host</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'grpcs://cache.depot.dev'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">auth</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">token</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'DEPOT_TOKEN'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># If you have multiple org's</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">headers</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">'X-Depot-Org'</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'&lt;id&gt;'</span><br></span></code></pre></div></div>
<p>You'll need to set the <code>DEPOT_TOKEN</code> environment variable on every machine that will use remote
caching.
<a href="https://moonrepo.dev/docs/guides/remote-cache#cloud-hosted-depot">Learn more about this flow in our documentation</a>.</p>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>moon itself now uses Depot Cache for its remote caching, and it has been working quite well! You can
see it in action within each pull request.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="miscellaneous">Miscellaneous<a href="https://moonrepo.dev/blog/moon-v1.32#miscellaneous" class="hash-link" aria-label="Direct link to Miscellaneous" title="Direct link to Miscellaneous">​</a></h3>
<ul>
<li>You can now use <code>http(s)</code> protocols for gRPC servers, instead of just <code>grpc(s)</code>.</li>
<li>Added timeouts and concurrency limits to our internal clients. In the future, we will also support
retrying.</li>
<li>Added a <code>MOON_DEBUG_REMOTE</code> environment variable, which can be used to debug internal errors for
diagnosing connection/integration issues.</li>
<li>Improved handling of TLS/mTLS connections.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-built-in-toolchains">Improved built-in toolchains<a href="https://moonrepo.dev/blog/moon-v1.32#improved-built-in-toolchains" class="hash-link" aria-label="Direct link to Improved built-in toolchains" title="Direct link to Improved built-in toolchains">​</a></h2>
<p>It's been quite some time since we've made any changes to our existing built-in toolchains, and
since there's been many updates in the ecosystem (like Deno v2), we felt it was time to do a pass on
them and introduce some improvements.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="bun">Bun<a href="https://moonrepo.dev/blog/moon-v1.32#bun" class="hash-link" aria-label="Direct link to Bun" title="Direct link to Bun">​</a></h3>
<ul>
<li>Added support for the new text-based <code>bun.lock</code> file in
<a href="https://bun.sh/blog/bun-v1.2#introducing-bun-lock" target="_blank" rel="noopener noreferrer">Bun v1.2</a>.<!-- -->
<ul>
<li>We do our best to detect between the text and binary formats, but we suggest configuring
<code>--save-text-lockfile</code> in <a href="https://moonrepo.dev/docs/config/toolchain#installargs"><code>bun.installArgs</code></a> to be
explicit.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="deno">Deno<a href="https://moonrepo.dev/blog/moon-v1.32#deno" class="hash-link" aria-label="Direct link to Deno" title="Direct link to Deno">​</a></h3>
<ul>
<li>Added support for <a href="https://deno.com/blog/v2.0" target="_blank" rel="noopener noreferrer">Deno v2</a>.<!-- -->
<ul>
<li>Now supports all lockfile versions (1-4), thanks to the official <code>deno_lockfile</code> crate.</li>
<li>Now uses <code>deno install</code> in v2+ instead of <code>deno cache</code> that was used in v1.</li>
<li>Added a new <a href="https://moonrepo.dev/docs/config/toolchain#installargs-1"><code>deno.installArgs</code></a> setting.</li>
</ul>
</li>
<li>Added support for workspaces that were introduced in <a href="https://deno.com/blog/v1.45" target="_blank" rel="noopener noreferrer">Deno v1.45</a>.<!-- -->
<ul>
<li>When a project is within a workspace, it will now install dependencies once in the workspace,
instead of in each project.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="python">Python<a href="https://moonrepo.dev/blog/moon-v1.32#python" class="hash-link" aria-label="Direct link to Python" title="Direct link to Python">​</a></h3>
<ul>
<li>Added unstable <a href="https://docs.astral.sh/uv/" target="_blank" rel="noopener noreferrer">uv support</a>. Can be enabled with the new
<a href="https://moonrepo.dev/docs/config/toolchain#packagemanager-1"><code>python.packageManager</code></a> and
<a href="https://moonrepo.dev/docs/config/toolchain#uv"><code>python.uv</code></a> settings.<!-- -->
<ul>
<li>Right now, has basic toolchain support, including dependency installs and virtual environments.</li>
<li>Uses <code>uv venv</code> instead of <code>python venv</code> and <code>uv sync</code> instead of <code>pip install</code>.</li>
<li>Relies on <code>pyproject.toml</code> and <code>uv.lock</code> instead of <code>requirements.txt</code>.</li>
</ul>
</li>
<li>Renamed the <code>python.rootRequirementsOnly</code> setting to
<a href="https://moonrepo.dev/docs/config/toolchain#rootvenvonly"><code>python.rootVenvOnly</code></a>. Open for discussion on the name of
this setting.</li>
<li>Will now inherit versions from the root <code>.prototools</code>.</li>
</ul>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/toolchain.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">python</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">version</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'3.12.0'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">packageManager</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'uv'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">uv</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">version</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'0.5.26'</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="rust">Rust<a href="https://moonrepo.dev/blog/moon-v1.32#rust" class="hash-link" aria-label="Direct link to Rust" title="Direct link to Rust">​</a></h3>
<ul>
<li>The root-level project is now properly taken into account when detecting if a project is within
the Cargo workspace.</li>
<li>Project dependencies (<code>dependsOn</code>) are now automatically inferred from <code>Cargo.toml</code> dependencies
(only <code>path</code> allowed).</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="pkl-configuration-now-available">Pkl configuration now available<a href="https://moonrepo.dev/blog/moon-v1.32#pkl-configuration-now-available" class="hash-link" aria-label="Direct link to Pkl configuration now available" title="Direct link to Pkl configuration now available">​</a></h2>
<p>In <a href="https://moonrepo.dev/blog/moon-v1.29">moon v1.29</a> we introduced support for Pkl-based (<code>.pkl</code>) configuration as an
alternative to YAML (<code>.yml</code>), but it was hidden behind an experimental flag. Going forward, you can
now use Pkl without having to enable the experimental flag, and can remove any references to
<code>--experimentPklConfig</code> or <code>MOON_EXPERIMENT_PKL_CONFIG</code>.</p>
<p>Additionally, we now have <a href="https://moonrepo.dev/docs/guides/pkl-config">official documentation on what Pkl is</a>, how to
use it, and some examples of what it looks like. Check it out!</p>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>Based on feedback from the community, and our current thoughts on the configuration problem, at this
point in time, we plan to support multiple configuration formats instead of choosing one, and will
most likely include support for JSON/JSONC in v2. We're also open to other formats that may work
well in moon, and are compatible with our current codebase.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.32#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.32.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added unstable support for multiple package workspaces when installing dependencies and resolving
lockfiles.</li>
<li>Reworked child process handling to better handle signals and shutdown accordingly. Additionally,
when the pipeline receives a signal, we now display the status that shutdown the pipeline in the
summary.</li>
<li>Reworked the new task <code>inferInputs</code> option to not infer environment variables from popular CI/CD
providers, as those values constantly change, causing tasks to always be affected. If you would
like to reference these values, add them as an explicit inputs.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="platform" term="platform"/>
        <category label="toolchain" term="toolchain"/>
        <category label="remote" term="remote"/>
        <category label="cache" term="cache"/>
        <category label="pkl" term="pkl"/>
        <category label="config" term="config"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.45 - New built-in tools and build from source]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.45</id>
        <link href="https://moonrepo.dev/blog/proto-v0.45"/>
        <updated>2025-01-22T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we're very excited to introduce building tools from source, a feature that's been]]></summary>
        <content type="html"><![CDATA[<p>In this release, we're very excited to introduce building tools from source, a feature that's been
in development for over a year.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-built-in-tools">New built-in tools<a href="https://moonrepo.dev/blog/proto-v0.45#new-built-in-tools" class="hash-link" aria-label="Direct link to New built-in tools" title="Direct link to New built-in tools">​</a></h2>
<p>It's been quite some time since we've introduced a new official built-in tool, so in this release,
we have 3!</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="moon"><code>moon</code><a href="https://moonrepo.dev/blog/proto-v0.45#moon" class="hash-link" aria-label="Direct link to moon" title="Direct link to moon">​</a></h3>
<p>This was a no-brainer, and honestly, we probably should have done it much sooner. We were quite
surprised to see that moon is the 3rd most installed tool in proto, right behind pnpm and node
respectively. We felt that it was now time to make it official.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> moon</span><br></span></code></pre></div></div>
<p>If you were using the moon TOML plugin before (below), you can now remove this entry from your
<code>.prototools</code>.</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.prototools</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">plugins</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">moon</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"https://raw.githubusercontent.com/moonrepo/moon/master/proto-plugin.toml"</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="uv"><code>uv</code><a href="https://moonrepo.dev/blog/proto-v0.45#uv" class="hash-link" aria-label="Direct link to uv" title="Direct link to uv">​</a></h3>
<p>Additionally, Python interest has grown over recent months, especially with the introduction of
<a href="https://moonrepo.dev/blog/moon-v1.30">Python support in moon</a>, so we felt it was time to support the new hotness,
<a href="https://docs.astral.sh/uv/" target="_blank" rel="noopener noreferrer">uv</a>! We plan to bring uv integration into moon in the near future.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> uv</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>Although uv can also manage Python installations, we suggest using proto to keep everything
streamlined and isolated.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="ruby"><code>ruby</code><a href="https://moonrepo.dev/blog/proto-v0.45#ruby" class="hash-link" aria-label="Direct link to ruby" title="Direct link to ruby">​</a></h3>
<p>And lastly, we now support <a href="https://www.ruby-lang.org/en/" target="_blank" rel="noopener noreferrer">Ruby</a>, a popular general purpose
programming language. Ruby was extremely difficult to support, primarily because Ruby does <em>not</em>
support the concept of pre-builts, and <em>must</em> be compiled from source files.</p>
<p>But thanks to our new build from source install strategy (below), Ruby support is now possible.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> ruby</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="build-from-source-unstable">Build from source (unstable)<a href="https://moonrepo.dev/blog/proto-v0.45#build-from-source-unstable" class="hash-link" aria-label="Direct link to Build from source (unstable)" title="Direct link to Build from source (unstable)">​</a></h2>
<p>Up until now, tools could only be installed if they supported pre-built binaries, which was
typically more than enough. However, there are many languages that do not support pre-builts and
must be built from source, such as Ruby, PHP, and up until recently, Python. Building binaries from
source code is actually quite complicated, as the instructions for doing so is different across
operating systems, architectures, and even system package managers.</p>
<p>Regardless, we've spent the past year slowly working on a solution and have finally managed to
implement something usable, all through a powerful WASM API. And with that, the following tools now
support build from source.</p>
<ul>
<li><code>deno</code></li>
<li><code>go</code></li>
<li><code>moon</code></li>
<li><code>node</code></li>
<li><code>python</code> (via <code>python-build</code>)</li>
<li><code>ruby</code> (via <code>ruby-build</code>)</li>
</ul>
<p>To actually build from source instead of downloading a prebuilt, simply pass <code>--build</code> to
<a href="https://moonrepo.dev/docs/proto/commands/install"><code>proto install</code></a>. For tools that only support build (like Ruby), the
<code>--build</code> flag is optional.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> python </span><span class="token parameter variable" style="color:#fef9c3">--build</span><br></span></code></pre></div></div>
<p>To demonstrate how this works, here's Go being built from source. We start by grouping operations
into steps, with the first step being the installation of system dependencies (via Homebrew or
something similar). We then check that certain requirements are met, or abort if unmet. Up next, we
need to acquire the source code, either by downloading an archive, or cloning a Git repository. And
lastly, running through and executing the build instructions/commands.</p>
<div style="margin-bottom:1rem;margin-top:1rem;text-align:center"><img src="https://moonrepo.dev/assets/images/go-build-de7f9a0ccd072826c49d285e780f1a9d.png" width="90%" alt="" class="inline-block"></div>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>While this feature is very exciting, it is extremely unstable, so please report any issues, and
provide any and all feedback!</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.45#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.45.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="tool" term="tool"/>
        <category label="build" term="build"/>
        <category label="source" term="source"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.31 - Toolchain progress, glob-based targets, task & remote cache improvements]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.31</id>
        <link href="https://moonrepo.dev/blog/moon-v1.31"/>
        <updated>2025-01-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Happy new years everyone 🎉! In this release, we've landed a handful of quality-of-life]]></summary>
        <content type="html"><![CDATA[<p>Happy new years everyone 🎉! In this release, we've landed a handful of quality-of-life
improvements.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="goodbye-platform-hello-toolchain">Goodbye platform, hello toolchain<a href="https://moonrepo.dev/blog/moon-v1.31#goodbye-platform-hello-toolchain" class="hash-link" aria-label="Direct link to Goodbye platform, hello toolchain" title="Direct link to Goodbye platform, hello toolchain">​</a></h2>
<p>In preparation for toolchain WASM plugins, we've had to rewrite and rethink a lot of the internals
of moon. Once such feature is the concept of a "platform", which is primarily interacted with
through a task's <a href="https://moonrepo.dev/docs/config/project#platform-1"><code>platform</code></a> setting or a project's
<a href="https://moonrepo.dev/docs/config/project#platform"><code>platform</code></a> setting.</p>
<p>We do our best to detect the language and runtime (the "platform") that a project or task belongs
to. This is important as it determines what tools to install, paths to include in <code>PATH</code>, and much
more. However, there are situations where our detection fails, or you need to be explicit, so the
<code>platform</code> settings exist.</p>
<p>The new toolchain system is much more powerful, but it works quite differently, so we're slowly
making changes within each release before flipping the switch. In this release, we are deprecating
the concept of the platform, and renaming everything to toolchain. The following changes were made:</p>
<ul>
<li>Deprecated the top-level <code>platform</code> setting in <code>moon.yml</code>, use <code>toolchain.default</code> instead.<!-- -->
<ul>
<li>Additionally, the toolchain can now be inferred from the top-level <code>language</code> setting and any
config files in the project/workspace root. This pattern is preferred when possible.</li>
</ul>
</li>
<li>Deprecated the <code>platform</code> task setting, use <code>toolchain</code> instead.</li>
<li>Deprecated the <code>taskPlatform</code> query field, use <code>taskToolchain</code> instead.</li>
<li>Deprecated the <code>--platform</code> option for <code>moon query tasks</code>, use <code>--toolchain</code> instead.</li>
<li>Deprecated the <code>$taskPlatform</code> token, use <code>$taskToolchain</code> instead.</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_WCGJ alert alert--warning"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_pbrs"><p>On the surface these two features look the same, but internally they are quite different. We've done
our best to support backwards compatibility, but there may be some edge cases that our testing suite
did not cover. If you run into any problems, mainly tasks being associated with the wrong toolchain,
please report an issue!</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="run-tasks-using-glob-based-targets">Run tasks using glob-based targets<a href="https://moonrepo.dev/blog/moon-v1.31#run-tasks-using-glob-based-targets" class="hash-link" aria-label="Direct link to Run tasks using glob-based targets" title="Direct link to Run tasks using glob-based targets">​</a></h2>
<p>This has been a request from the community for sometime, as it fills a gap that running multiple
tasks with a non-project scope, or running tasks with a query, simply couldn't achieve. For example,
say you had <code>build-debug</code> and <code>build-release</code> tasks, and wanted to future-proof it for potential new
build related tasks.</p>
<p>Before this release, you would need to explicitly list all targets in
<a href="https://moonrepo.dev/docs/commands/run"><code>moon run</code></a> or <a href="https://moonrepo.dev/docs/commands/ci"><code>moon ci</code></a>, but with globs, you can achieve
the same affect with 1 glob target.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># Before</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon run :build-debug :build-release</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># After</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon run </span><span class="token string" style="color:#c9e166">':build-*'</span><br></span></code></pre></div></div>
<p>Furthermore, glob syntax can also be applied to the project scope, allowing you to filter the target
instead of applying to all projects.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon run </span><span class="token string" style="color:#c9e166">'*-{app,lib}:build-*'</span><br></span></code></pre></div></div>
<p>Because these glob targets are real globs, they support all the
<a href="https://moonrepo.dev/docs/concepts/file-pattern#globs">same syntax</a> as other glob related functionality, but we suggest
keeping it simple and sticking to <code>*</code>, <code>[]</code>, and <code>{}</code>.</p>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>Be sure to quote targets that contain glob syntax, otherwise your shell native glob expansion may
trigger instead, or your shell may fail with an error.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="task-improvements">Task improvements<a href="https://moonrepo.dev/blog/moon-v1.31#task-improvements" class="hash-link" aria-label="Direct link to Task improvements" title="Direct link to Task improvements">​</a></h2>
<p>We also spent some time improving the ergonomics of tasks, our most important feature.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="inferring-inputs">Inferring inputs<a href="https://moonrepo.dev/blog/moon-v1.31#inferring-inputs" class="hash-link" aria-label="Direct link to Inferring inputs" title="Direct link to Inferring inputs">​</a></h3>
<p>Up until now, you had to explicitly configure the <a href="https://moonrepo.dev/docs/config/project#inputs"><code>inputs</code></a> of a task.
This can be very tedious, so we're looking into ways to automate this. The first is through a new
feature we are calling "inferring inputs from task parameters", where we automatically include
inputs from any file group token functions and substituted environment variables, found within
<code>command</code>, <code>script</code>, <code>args</code>, or <code>env</code>.</p>
<p>To demonstate this, here's a task that utilizes file group tokens in previous releases.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">lint</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'lint @group(sources) @group(tests)'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'@group(sources)'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'@group(tests)'</span><br></span></code></pre></div></div>
<p>As you can immediately tell, there's a fair bit of duplication here. Going forward, the tokens found
within <code>inputs</code> can be omitted, as we can infer that the files defined in the <code>sources</code> and <code>tests</code>
file groups should be inputs. The task above can simply be rewritten as.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">lint</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'lint @group(sources) @group(tests)'</span><br></span></code></pre></div></div>
<p>Useful right? However, if you do <em>not</em> want this functionality, you can disable it with the new task
option <a href="https://moonrepo.dev/docs/config/project#inferinputs"><code>inferInputs</code></a> (which is enabled by default).</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">lint</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">inferInputs</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="always-run-in-ci">Always run in CI<a href="https://moonrepo.dev/blog/moon-v1.31#always-run-in-ci" class="hash-link" aria-label="Direct link to Always run in CI" title="Direct link to Always run in CI">​</a></h3>
<p>The <a href="https://moonrepo.dev/docs/config/project#runinci"><code>runInCI</code></a> task option pairs nicely with the <code>moon ci</code> command,
as it does most of the heavy lifting in determining what tasks to run based on affected/touched
files. However, there are sometimes situations where a task should <em>always</em> run in CI, regardless of
whether it was affected or not.</p>
<p>This isn't currently possible in moon, until now! We've updated the <code>runInCI</code> option to support a
new value, "always", which will always run the task in CI!</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">runInCI</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'always'</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="remote-cache-improvements">Remote cache improvements<a href="https://moonrepo.dev/blog/moon-v1.31#remote-cache-improvements" class="hash-link" aria-label="Direct link to Remote cache improvements" title="Direct link to Remote cache improvements">​</a></h2>
<p>In our last release, v1.30, we released
<a href="https://moonrepo.dev/blog/moon-v1.30#unstable-self-hosted-remote-caching">unstable support for self-hosted remote caching</a>.
While still unstable in this release, we've landed more improvements.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="zstandard-compression">Zstandard compression<a href="https://moonrepo.dev/blog/moon-v1.31#zstandard-compression" class="hash-link" aria-label="Direct link to Zstandard compression" title="Direct link to Zstandard compression">​</a></h3>
<p>We've added a new setting,
<a href="https://moonrepo.dev/docs/config/workspace#compression"><code>unstable_remote.cache.compression</code></a>, that defines a
compression format to use when uploading and downloading blobs. At this time, we only support <code>zstd</code>
as an option, which is <em>not</em> enabled by default.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">unstable_remote</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">cache</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">compression</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'zstd'</span><br></span></code></pre></div></div>
<p>If you're using <code>bazel-remote</code> as your cache server, you'll also need to run it with zstandard
enabled.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ bazel-remote </span><span class="token parameter variable" style="color:#fef9c3">--dir</span><span class="token plain"> /path/to/moon-cache </span><span class="token parameter variable" style="color:#fef9c3">--max_size</span><span class="token plain"> </span><span class="token number" style="color:#94dded">10</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--storage_mode</span><span class="token plain"> zstd </span><span class="token parameter variable" style="color:#fef9c3">--grpc_address</span><span class="token plain"> </span><span class="token number" style="color:#94dded">0.0</span><span class="token plain">.0.0:9092</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="symlinking-on-windows">Symlinking on Windows<a href="https://moonrepo.dev/blog/moon-v1.31#symlinking-on-windows" class="hash-link" aria-label="Direct link to Symlinking on Windows" title="Direct link to Symlinking on Windows">​</a></h3>
<p>In the previous release, if we encountered an output blob that should be created as a symlink, we
would simply copy the file contents on Windows when restoring instead of symlinking. On Unix, these
outputs were symlinked correctly.</p>
<p>The reason for this, is that symlinks require
<a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/security-policy-settings/create-symbolic-links" target="_blank" rel="noopener noreferrer">privileged access on Windows</a>
to function correctly. We felt that abiding the REAPI specification was more important than the
privileged access requirement, so if you're on Windows, be sure to allow/enable symlinks on each
machine.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="sunsetting-moonbase">Sunsetting moonbase<a href="https://moonrepo.dev/blog/moon-v1.31#sunsetting-moonbase" class="hash-link" aria-label="Direct link to Sunsetting moonbase" title="Direct link to Sunsetting moonbase">​</a></h3>
<p>Since we're migrating to and advocating for the self-hosted remote caching solution, we will be
sunsetting our <a href="https://moonrepo.dev/moonbase">moonbase</a> product hosted at <a href="https://moonrepo.app/" target="_blank" rel="noopener noreferrer">https://moonrepo.app</a> on March 31st. All
active subscriptions will be cancelled at the end of February, but caching will continue to work,
albeit at the unpaid plan limits. We suggest migrating to the self-hosted solution before then!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.31#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.31.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added glob support (and <code>glob://</code>) to <code>generator.templates</code> in <code>.moon/workspace.yml</code>, allowing you
to glob for your codegen template locations.</li>
<li>Added a <code>--filter</code> option to <code>moon templates</code>.</li>
<li>Updated the <code>extends</code> setting in <code>.moon/workspace.yml</code>, <code>toolchain.yml</code>, and <code>tasks.yml</code>, to
support a list of files/URLs to extend.</li>
<li>Updated toolchain dependency installs to retry up to 3 attempts if the install command fails.</li>
<li>Improved the task output prefixing logic.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="platform" term="platform"/>
        <category label="toolchain" term="toolchain"/>
        <category label="glob" term="glob"/>
        <category label="task" term="task"/>
        <category label="target" term="target"/>
        <category label="remote" term="remote"/>
        <category label="cache" term="cache"/>
        <category label="ci" term="ci"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.44 - New terminal user interface and versions command]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.44</id>
        <link href="https://moonrepo.dev/blog/proto-v0.44"/>
        <updated>2024-12-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Merry Christmas and happy holidays 🎄! In this release, we're introducing a new terminal user]]></summary>
        <content type="html"><![CDATA[<p>Merry Christmas and happy holidays 🎄! In this release, we're introducing a new terminal user
interface.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-terminal-output">New terminal output<a href="https://moonrepo.dev/blog/proto-v0.44#new-terminal-output" class="hash-link" aria-label="Direct link to New terminal output" title="Direct link to New terminal output">​</a></h2>
<p>We're excited to introduce new terminal outputs, also known as a terminal user interface (TUI), for
all commands! We stumbled upon the <a href="https://docs.rs/iocraft/latest/iocraft/" target="_blank" rel="noopener noreferrer">iocraft</a> Rust crate,
which is a library for rendering terminal output using components and JSX-like syntax. As fans of
<a href="https://react.dev/" target="_blank" rel="noopener noreferrer">React</a> and <a href="https://github.com/vadimdemedes/ink" target="_blank" rel="noopener noreferrer">Ink</a>, this felt like the
perfect opportunity to revisit all of our commands and implement a new interface unique to proto
(and moon in the future).</p>
<p>Here are some examples of this new output. A lot of it is still a work in progress and will be
tweaked going forward, but we're already impressed with what iocraft can achieve!</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="notices">Notices<a href="https://moonrepo.dev/blog/proto-v0.44#notices" class="hash-link" aria-label="Direct link to Notices" title="Direct link to Notices">​</a></h3>
<div style="margin-bottom:1rem;margin-top:1rem;text-align:center"><img src="https://moonrepo.dev/assets/images/notice-success-254582753244b00934c95f97dec3a919.png" width="90%" alt="" class="inline-block"></div>
<div style="margin-bottom:1rem;margin-top:1rem;text-align:center"><img src="https://moonrepo.dev/assets/images/notice-caution-79cdc2e8db63979fdbb49bbcd67ea59f.png" width="90%" alt="" class="inline-block"></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="information">Information<a href="https://moonrepo.dev/blog/proto-v0.44#information" class="hash-link" aria-label="Direct link to Information" title="Direct link to Information">​</a></h3>
<div style="margin-bottom:1rem;margin-top:1rem;text-align:center"><img src="https://moonrepo.dev/assets/images/info-env-861de6c24686136db952da1e09efd792.png" width="90%" alt="" class="inline-block"></div>
<div style="margin-bottom:1rem;margin-top:1rem;text-align:center"><img src="https://moonrepo.dev/assets/images/info-plugin-435cf590895a9bf7adf9b30a70e21433.png" width="90%" alt="" class="inline-block"></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="tables">Tables<a href="https://moonrepo.dev/blog/proto-v0.44#tables" class="hash-link" aria-label="Direct link to Tables" title="Direct link to Tables">​</a></h3>
<div style="margin-bottom:1rem;margin-top:1rem;text-align:center"><img src="https://moonrepo.dev/assets/images/table-outdated-2192bf6b51844be592f479137a5c5cb8.png" width="90%" alt="" class="inline-block"></div>
<div style="margin-bottom:1rem;margin-top:1rem;text-align:center"><img src="https://moonrepo.dev/assets/images/table-search-49163a166a105c87d96f0f25fbc700cf.png" width="90%" alt="" class="inline-block"></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="prompts">Prompts<a href="https://moonrepo.dev/blog/proto-v0.44#prompts" class="hash-link" aria-label="Direct link to Prompts" title="Direct link to Prompts">​</a></h3>
<div style="margin-bottom:1rem;margin-top:1rem;text-align:center"><img src="https://moonrepo.dev/assets/images/confirm-ce50d89b46c868773b6da77167a32c0c.png" width="90%" alt="" class="inline-block"></div>
<div style="margin-bottom:1rem;margin-top:1rem;text-align:center"><img src="https://moonrepo.dev/assets/images/select-a9dd0acb274c17036b9ecfb7499d31be.png" width="90%" alt="" class="inline-block"></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="progress">Progress<a href="https://moonrepo.dev/blog/proto-v0.44#progress" class="hash-link" aria-label="Direct link to Progress" title="Direct link to Progress">​</a></h3>
<div style="margin-bottom:1rem;margin-top:1rem;text-align:center"><img src="https://moonrepo.dev/assets/images/progress-7fae1a2f6c3daa0aa4ea2a1d5a7dd52f.png" width="90%" alt="" class="inline-block"></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-proto-versions-command">New <code>proto versions</code> command<a href="https://moonrepo.dev/blog/proto-v0.44#new-proto-versions-command" class="hash-link" aria-label="Direct link to new-proto-versions-command" title="Direct link to new-proto-versions-command">​</a></h2>
<p>After much feedback, we've decided to merge the <code>proto list</code> and <code>proto list-remote</code> commands into a
new command, <a href="https://moonrepo.dev/docs/proto/commands/versions"><code>proto versions</code></a>. This command will list all versions
available for the provided tool, while also annotating which of those versions has been installed
locally.</p>
<p>This data can now be accessed as JSON by passing the <code>--json</code> flag.</p>
<div class="language-shel codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shel codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto versions node</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">...</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.0.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.1.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.2.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.3.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.4.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.4.1</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.5.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.5.1</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.6.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.7.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.8.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.9.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.10.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.11.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">22.12.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">23.0.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">23.1.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">23.2.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">23.3.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">23.4.0 - installed 12/19/24</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">23.5.0 - installed 12/25/24</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.44#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.44.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added a <code>--yes</code> option to <code>proto outdated</code>, that skips confirmation prompts.</li>
<li>Added a <code>--json</code> option to <code>proto clean</code>, to capture the cleaned result as JSON.</li>
<li>Updated <code>proto clean</code> to accept a target in which to clean as the 1st argument. For example,
<code>proto clean cache</code>.</li>
<li>Moved the <code>--json</code> and <code>--yes</code> options into global options.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="terminal" term="terminal"/>
        <category label="console" term="console"/>
        <category label="ui" term="ui"/>
        <category label="user" term="user"/>
        <category label="interface" term="interface"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.30 - Python support, self-hosted remote caching, task graph, and more!]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.30</id>
        <link href="https://moonrepo.dev/blog/moon-v1.30"/>
        <updated>2024-11-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[It's been almost 2 months since our last release, and we're excited to announce some major features]]></summary>
        <content type="html"><![CDATA[<p>It's been almost 2 months since our last release, and we're excited to announce some major features
requested by the community!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="experimental-python-tier-2-and-3-support">Experimental Python tier 2 and 3 support<a href="https://moonrepo.dev/blog/moon-v1.30#experimental-python-tier-2-and-3-support" class="hash-link" aria-label="Direct link to Experimental Python tier 2 and 3 support" title="Direct link to Experimental Python tier 2 and 3 support">​</a></h2>
<p>Thanks to a contribution from <a href="https://github.com/harlequin" target="_blank" rel="noopener noreferrer">@harlequin</a>, we now provide Python tier
<a href="https://moonrepo.dev/docs/how-it-works/languages#tier-2--platform">2</a> and
<a href="https://moonrepo.dev/docs/how-it-works/languages#tier-3--toolchain">3</a> support. Python is a very popular language, so
it was about time that we officially supported it in some capacity. When enabling Python in moon,
the following functionality will be enabled:</p>
<ul>
<li>Will download and install Python into the toolchain (if <code>python.version</code> is defined).</li>
<li>Will parse <code>requirements.txt</code> to extract dependency and version information for hashing.</li>
<li>Will automatically activate virtual environments and setup <code>PATH</code> for tasks.</li>
<li>Will automatically install dependencies for <code>requirements.txt</code> via pip.</li>
<li>And a handful of internal interoperability features.</li>
</ul>
<p>However, we're still marking this implementation as experimental, as it hasn't been thoroughly
tested, and we're not 100% positive the workflows are what users expect. So please provide any
feedback, good or bad!</p>
<p>Furthermore, as mentioned above, we install dependencies with pip (the version of pip that comes
pre-installed with the current Python version). At this time, <em>we do not support</em> other package
managers like Poetry, Hatch, PDM, Rye, or uv, but we will in the future!</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="new-python-configurations">New <code>python</code> configurations<a href="https://moonrepo.dev/blog/moon-v1.30#new-python-configurations" class="hash-link" aria-label="Direct link to new-python-configurations" title="Direct link to new-python-configurations">​</a></h3>
<p>Languages in
<a href="https://moonrepo.dev/docs/how-it-works/languages#enabling-a-language">moon are enabled through configuration</a> blocks in
<a href="https://moonrepo.dev/docs/config/toolchain"><code>.moon/toolchain.yml</code></a>, and Python is no different. We now support a
<a href="https://moonrepo.dev/docs/config/toolchain#python"><code>python</code></a> toolchain setting
(<a href="https://moonrepo.dev/docs/config/toolchain">view all available settings</a>).</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/toolchain.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">python</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">version</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'3.14.0'</span><br></span></code></pre></div></div>
<p>When the <code>python</code> setting is defined, it will enable the language and
<a href="https://moonrepo.dev/docs/how-it-works/languages#tier-2--platform">deep platform integration</a>, and when the
<code>python.version</code> field is defined, it will further enable
<a href="https://moonrepo.dev/docs/how-it-works/languages#tier-3--toolchain">toolchain support</a>. Both of these features provide
heavy automation, improving the overall developer experience.</p>
<p>This is fantastic, but what if another Python project in the monorepo requires a different toolchain
channel/version? If so, they can use the new <a href="https://moonrepo.dev/docs/config/project#python"><code>toolchain.python</code></a>
setting in <a href="https://moonrepo.dev/docs/config/project"><code>moon.yml</code></a> to define project-level overrides.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">&lt;project&gt;/moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">toolchain</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">python</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">version</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'3.12.0'</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="built-in-virtual-environments">Built-in virtual environments<a href="https://moonrepo.dev/blog/moon-v1.30#built-in-virtual-environments" class="hash-link" aria-label="Direct link to Built-in virtual environments" title="Direct link to Built-in virtual environments">​</a></h3>
<p>Of course we also have support for Python virtual environments. When running a task, moon will
automatically enable the virtual environment in the workspace root or a project root (depending on
config)! The name of the venv can be customized with the
<a href="https://moonrepo.dev/docs/config/toolchain#venvname"><code>python.venvName</code></a> setting, otherwise it defaults to <code>.venv</code>.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/toolchain.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">python</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">venvName</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'.venvcustom'</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="unstable-self-hosted-remote-caching">Unstable self-hosted remote caching<a href="https://moonrepo.dev/blog/moon-v1.30#unstable-self-hosted-remote-caching" class="hash-link" aria-label="Direct link to Unstable self-hosted remote caching" title="Direct link to Unstable self-hosted remote caching">​</a></h2>
<p>This has been a request from the community for a very long time, and we get it, not every user wants
to store their build artifacts (not source code) in a third-party cloud provider. While we're proud
of our <a href="https://moonrepo.dev/moonbase">moonbase service</a>, it wasn't a viable option for many companies because of their
proprietary requirements. We spent a few months reworking moonbase to work as a self-hosted service,
so users can host it as on-prem solution, but it has been a very costly initiative. During this
process, we came to the conclusion that spending our time and resources on moonbase simply isn't
worth it, so we made the hard decision to sunset moonbase in the future.</p>
<p>So what does that mean for remote caching? Simply put, you can now host your own remote caching
service! Instead of building a custom API for consumers to implement, we opted to implement the
<a href="https://github.com/bazelbuild/remote-apis/blob/main/build/bazel/remote/execution/v2/remote_execution.proto" target="_blank" rel="noopener noreferrer">Bazel Remote Execution API</a>,
which supports a content addressable storage (CAS) API, and is used by other popular build tools,
like Bazel, Buck, Pants, and more!</p>
<p>Because we opted for a community solution, we can now focus all our efforts on <a href="https://moonrepo.dev/moon">moon</a> and
<a href="https://moonrepo.dev/proto">proto</a>! Additionally, adopting RE API allows you, the user, to use an off-the-shelf
solution, like <a href="https://github.com/buchgr/bazel-remote" target="_blank" rel="noopener noreferrer"><code>bazel-remote</code></a>, instead of building your
own custom caching server! For example, to make use of remote caching, simply serve <code>bazel-remote</code>:</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">bazel-remote </span><span class="token parameter variable" style="color:#fef9c3">--dir</span><span class="token plain"> /path/to/moon-cache </span><span class="token parameter variable" style="color:#fef9c3">--max_size</span><span class="token plain"> </span><span class="token number" style="color:#94dded">10</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--storage_mode</span><span class="token plain"> uncompressed </span><span class="token parameter variable" style="color:#fef9c3">--grpc_address</span><span class="token plain"> </span><span class="token number" style="color:#94dded">0.0</span><span class="token plain">.0.0:9092</span><br></span></code></pre></div></div>
<p>And then configure the new <a href="https://moonrepo.dev/docs/config/workspace#unstable_remote"><code>unstable_remote</code></a> setting in
<a href="https://moonrepo.dev/docs/config/workspace"><code>.moon/workspace.yml</code></a>.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">unstable_remote</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">host</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'grpc://your-host.com:9092'</span><br></span></code></pre></div></div>
<p>Pretty awesome right? Jump to the
<a href="https://moonrepo.dev/docs/guides/remote-cache#self-hosted-unstable">official remote caching</a> documentation for more
information on this implementation.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="unsupported-features">Unsupported features<a href="https://moonrepo.dev/blog/moon-v1.30#unsupported-features" class="hash-link" aria-label="Direct link to Unsupported features" title="Direct link to Unsupported features">​</a></h3>
<p>Since this is a new feature, we're marking it as unstable, as it hasn't been thoroughly tested, and
<em>does not</em> support the entire Bazel RE API. The following features <em>have not</em> been implemented, but
will be in the future.</p>
<ul>
<li>HTTP(S) host (we only support gRPC(S))</li>
<li>Digest hashing functions besides SHA256</li>
<li>Compression formats (we only support identity/uncompressed right now)</li>
<li>Write/read bytestream for large blobs (4mb is the current limit)</li>
<li>Better TLS/mTLS support (it has some issues)</li>
<li>Directory blob types</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-task-graph-and-improved-affected-tracker">New task graph and improved affected tracker<a href="https://moonrepo.dev/blog/moon-v1.30#new-task-graph-and-improved-affected-tracker" class="hash-link" aria-label="Direct link to New task graph and improved affected tracker" title="Direct link to New task graph and improved affected tracker">​</a></h2>
<p>In our <a href="https://moonrepo.dev/blog/moon-v1.29#new-affected-projects-tracker">last release</a>, we announced a new affected
tracker for projects, but <em>not</em> for tasks. The reason behind this was simple, we couldn't! Up until
now, we had no concept of a task graph, we had a project graph (that had tasks) and an action graph
(that ran tasks), but the relationships between tasks were split across both of these graphs.</p>
<p>This made it complicated to support tasks for the new affected tracker, as the action graph
<em>consumes</em> the tracker, not the other way around. To remedy this issue, we now support an official
task graph, which is derived from the project graph, and then feeds into the action graph. Since the
task graph sits outside of the action graph, we're now able to support tasks in the affected
tracker!</p>
<p>Because of the new task graph, the following improvements have been introduced:</p>
<ul>
<li>Tasks are now supported in the affected tracker (as mentioned).</li>
<li>We can now properly query dependencies and dependents of specific tasks.</li>
<li>We can now associate types to relationships (graph edges). For example, in the future we can add
optional, cleanup, and other kinds of dependencies.</li>
<li>We've added a new command, <a href="https://moonrepo.dev/docs/commands/task-graph"><code>moon task-graph</code></a>, that can visualize
tasks in isolation.</li>
<li>We've updated the <a href="https://moonrepo.dev/docs/commands/query/tasks"><code>moon query tasks</code></a> to derive information from the
task graph.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.30#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.30.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added basic support for Git submodules, and will now extract touched files from all submodules.</li>
<li>Added 7 new token variables: <code>$arch</code>, <code>$os</code>, <code>$osFamily</code>, <code>$vcsBranch</code>, <code>$vcsRepository</code>,
<code>$vcsRevision</code>, <code>$workingDir</code></li>
<li>Added a <code>rust.binstallVersion</code> setting to <code>.moon/toolchain.yml</code>.</li>
<li>Updated Pkl configurations to support <code>read()</code> for environment variables.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="affected" term="affected"/>
        <category label="detection" term="detection"/>
        <category label="tracker" term="tracker"/>
        <category label="task" term="task"/>
        <category label="graph" term="graph"/>
        <category label="self-hosted" term="self-hosted"/>
        <category label="remote" term="remote"/>
        <category label="cache" term="cache"/>
        <category label="python" term="python"/>
        <category label="toolchain" term="toolchain"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.42 - New bin linking, JSON/YAML plugins, and more]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.42</id>
        <link href="https://moonrepo.dev/blog/proto-v0.42"/>
        <updated>2024-10-31T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Happy Halloween 🎃! In this release, we have a new bin linking strategy, and more schema plugin]]></summary>
        <content type="html"><![CDATA[<p>Happy Halloween 🎃! In this release, we have a new bin linking strategy, and more schema plugin
formats.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-bin-linking-strategy">New bin linking strategy<a href="https://moonrepo.dev/blog/proto-v0.42#new-bin-linking-strategy" class="hash-link" aria-label="Direct link to New bin linking strategy" title="Direct link to New bin linking strategy">​</a></h2>
<p>Early on in proto's development, we added <code>~/.proto/bin</code> symlink support for installed tools, but
chose to base it on the versions globally pinned in <code>~/.proto/.prototools</code>. We opted for this
approach as there wasn't a better solution at the time, and we merely wanted an alternative to
shims. Since then, bin linking has become an after-thought.</p>
<p>However, a suggestion from <a href="https://github.com/meop" target="_blank" rel="noopener noreferrer">@meop</a> sparked a great idea for the future of
bin linking. Instead of symlinking bins based on versions pinned in <code>~/.proto/.prototools</code>, bins are
now symlinked based on all of the versions installed, but grouped according to version ranges. The
main binary will always point to the highest installed version, while we also create binaries for
the highest major, and highest major + minor combinations.</p>
<p>For example, for Node.js (<code>node</code>), we may have the following:</p>
<ul>
<li><code>~/.proto/bin/node</code> - Points to the highest version.</li>
<li><code>~/.proto/bin/node-&lt;major&gt;</code> - Points to the highest version within that major range (<code>~major</code>). Is
created for each separate major version, for example: <code>node-20</code>, <code>node-22</code>.</li>
<li><code>~/.proto/bin/node-&lt;major&gt;.&lt;minor&gt;</code> - Points to the highest version within that major + minor
range (<code>~major.minor</code>). Is created for each separate major + minor version, for example:
<code>node-20.1</code>, <code>node-22.4</code>.</li>
<li><code>~/.proto/bin/node-canary</code> - Points to a canary install, if it exists.</li>
</ul>
<p>Thanks to this approach, you could easily execute commands with specific versions of a tool,
<em>without</em> having to set environment variables, update configurations, or force overrides. Just
execute the binary directly!</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--version</span><span class="token plain"> </span><span class="token operator" style="color:#b7a9f9">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">which</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token number" style="color:#94dded">23.1</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">~/.proto/bin/node -</span><span class="token operator" style="color:#b7a9f9">&gt;</span><span class="token plain"> ~/.proto/tools/node/23.1.0/bin/node</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ node-22 </span><span class="token parameter variable" style="color:#fef9c3">--version</span><span class="token plain"> </span><span class="token operator" style="color:#b7a9f9">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">which</span><span class="token plain"> node-22</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token number" style="color:#94dded">22.5</span><span class="token plain">.1</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">~/.proto/bin/node-22 -</span><span class="token operator" style="color:#b7a9f9">&gt;</span><span class="token plain"> ~/.proto/tools/node/22.5.1/bin/node</span><br></span></code></pre></div></div>
<blockquote>
<p>This change is not retroactive and will slowly be applied tool-by-tool when it is installed. To
force relinking of all binaries, you can use <code>proto regen --bin</code> after upgrading.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="support-for-json-and-yaml-based-plugins">Support for JSON and YAML based plugins<a href="https://moonrepo.dev/blog/proto-v0.42#support-for-json-and-yaml-based-plugins" class="hash-link" aria-label="Direct link to Support for JSON and YAML based plugins" title="Direct link to Support for JSON and YAML based plugins">​</a></h2>
<p>Support for TOML based plugins, an alternative to WASM based plugins, was integrated in proto v0.7;
which is 35 versions ago! Since then, we've had great success with TOML plugins, as they represent
about 97% of all plugins in the registry. The other 3% is WASM of course.</p>
<p>However, TOML is a configuration format that is quite unknown outside of the Rust ecosystem, and has
a bit of a learning curve for new users. To ease the plugin authoring process, we now support JSON
and YAML based plugins! To demonstrate this, here's our official moon plugin in all 3 formats:</p>
<div class="tabs-container tabList_J5MA"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_l0OV">JSON</li><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_l0OV tabs__item--active">TOML</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_l0OV">YAML</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_wHwb" hidden=""><div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">moon.json</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"name"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"moon"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"type"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"cli"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"platform"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"linux"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"downloadFile"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"moon-{arch}-unknown-linux-{libc}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"macos"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"downloadFile"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"moon-{arch}-apple-darwin"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"windows"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"downloadFile"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"moon-{arch}-pc-windows-msvc.exe"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"install"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"downloadUrl"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"https://github.com/moonrepo/moon/releases/download/v{version}/{download_file}"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"downloadUrlCanary"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"https://github.com/moonrepo/moon/releases/download/canary/{download_file}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"resolve"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"gitUrl"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"https://github.com/moonrepo/moon"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"metadata"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"selfUpgradeCommands"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token string" style="color:#c9e166">"upgrade"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">}</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_wHwb"><div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">moon.toml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key property" style="color:#b7a9f9">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"moon"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"cli"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">platform</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">platform.linux</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">download-file</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"moon-{arch}-unknown-linux-{libc}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">platform.macos</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">download-file</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"moon-{arch}-apple-darwin"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">platform.windows</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">download-file</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"moon-{arch}-pc-windows-msvc.exe"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">install</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">download-url</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"https://github.com/moonrepo/moon/releases/download/v{version}/{download_file}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">download-url-canary</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"https://github.com/moonrepo/moon/releases/download/canary/{download_file}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">resolve</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">git-url</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"https://github.com/moonrepo/moon"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">metadata</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">self-upgrade-commands</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"upgrade"</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">]</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_wHwb" hidden=""><div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">moon.yaml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">name</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'moon'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">type</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'cli'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">platform</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">linux</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">downloadFile</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'moon-{arch}-unknown-linux-{libc}'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">macos</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">downloadFile</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'moon-{arch}-apple-darwin'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">windows</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">downloadFile</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'moon-{arch}-pc-windows-msvc.exe'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">install</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">downloadUrl</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'https://github.com/moonrepo/moon/releases/download/v{version}/{download_file}'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">downloadUrlCanary</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'https://github.com/moonrepo/moon/releases/download/canary/{download_file}'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">resolve</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">gitUrl</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'https://github.com/moonrepo/moon'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">selfUpgradeCommands</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'upgrade'</span><br></span></code></pre></div></div></div></div></div>
<blockquote>
<p>JSON and YAML use camelCase keys, while TOML uses kebab-case.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.42#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.42.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Each tool's primary executable file name is no longer based on the plugin's identifier, and is now
based on what's configured in the new <code>LocateExecutablesOutput.exes</code> setting.</li>
<li>We now cache all text-based HTTP requests made from WASM plugins for 12 hours. This should greatly
reduce the overhead cost of making requests, and will help for situations where an internet
connection is lost.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="bin" term="bin"/>
        <category label="link" term="link"/>
        <category label="strategy" term="strategy"/>
        <category label="json" term="json"/>
        <category label="yaml" term="yaml"/>
        <category label="plugin" term="plugin"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.29 - Improved affected tracking, experimental Pkl configuration, and more]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.29</id>
        <link href="https://moonrepo.dev/blog/moon-v1.29"/>
        <updated>2024-10-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we're excited to introduce an improved affected tracker and a new (but]]></summary>
        <content type="html"><![CDATA[<p>In this release, we're excited to introduce an improved affected tracker and a new (but
experimental) configuration format!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-affected-projects-tracker">New affected projects tracker<a href="https://moonrepo.dev/blog/moon-v1.29#new-affected-projects-tracker" class="hash-link" aria-label="Direct link to New affected projects tracker" title="Direct link to New affected projects tracker">​</a></h2>
<p>We've received a lot of feedback that our affected projects and tasks logic works differently across
commands, or that it's hard to understand why something is affected or not affected. We wanted to
add more clarity around affected projects, so have implemented a new affected tracker.</p>
<p>This new tracker includes a ton of new logging that we believe will answer the "why". For example,
once the tracker has finished tracking, we'll log all affected projects and tasks, and what marked
their affected state.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain">DEBUG</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> moon_affected::affected_tracker  Project website is affected by  </span><span class="token assign-left variable" style="color:#fef9c3">files</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"website/blog/2024-10-01_moon-v1.29.mdx"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">upstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">downstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">other</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token plain">false</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain">DEBUG</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> moon_affected::affected_tracker  Project runtime is affected by </span><span class="token assign-left variable" style="color:#fef9c3">files</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">upstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">downstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"website"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">other</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token plain">false</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain">DEBUG</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> moon_affected::affected_tracker  Project types is affected by  </span><span class="token assign-left variable" style="color:#fef9c3">files</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">upstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">downstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"website"</span><span class="token plain">, </span><span class="token string" style="color:#c9e166">"runtime"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">other</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token plain">false</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain">DEBUG</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> moon_affected::affected_tracker  Task runtime:build is affected by  </span><span class="token assign-left variable" style="color:#fef9c3">env</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">files</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">upstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">downstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"website:start"</span><span class="token plain">, </span><span class="token string" style="color:#c9e166">"website:build"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">other</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token plain">false</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain">DEBUG</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> moon_affected::affected_tracker  Task website:start is affected by  </span><span class="token assign-left variable" style="color:#fef9c3">env</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">files</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"website/blog/2024-10-01_moon-v1.29.mdx"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">upstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">downstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">other</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token plain">false</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain">DEBUG</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> moon_affected::affected_tracker  Task types:build is affected by  </span><span class="token assign-left variable" style="color:#fef9c3">env</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">files</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">upstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">downstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"website:start"</span><span class="token plain">, </span><span class="token string" style="color:#c9e166">"runtime:build"</span><span class="token plain">, </span><span class="token string" style="color:#c9e166">"website:build"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">other</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token plain">false</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain">DEBUG</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> moon_affected::affected_tracker  Task website:build is affected by  </span><span class="token assign-left variable" style="color:#fef9c3">env</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">files</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"website/blog/2024-10-01_moon-v1.29.mdx"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">upstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">downstream</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#fef9c3">other</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token plain">false</span><br></span></code></pre></div></div>
<p>What marks an affected state is based on one or many of the following:</p>
<ul>
<li>By touched files</li>
<li>By environment variables (task only)</li>
<li>By upstream dependencies</li>
<li>By downstream dependents (project only)</li>
<li>And other minor internal logic</li>
</ul>
<p>This information is also included in the run report at <code>.moon/cache/runReport.json</code>, under the
<code>context.affected</code> property. An example of this looks like:</p>
<div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"projects"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"website"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"files"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"website/blog/2024-10-01_moon-v1.29.mdx"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"other"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"runtime"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"downstream"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"website"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"other"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"types"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"downstream"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"website"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"runtime"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"other"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"tasks"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"website:build"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"files"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"website/blog/2024-10-01_moon-v1.29.mdx"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"other"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"types:build"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"downstream"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"website:build"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"other"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"runtime:build"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"downstream"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"website:build"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"other"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="control-upstream--downstream-depth">Control upstream / downstream depth<a href="https://moonrepo.dev/blog/moon-v1.29#control-upstream--downstream-depth" class="hash-link" aria-label="Direct link to Control upstream / downstream depth" title="Direct link to Control upstream / downstream depth">​</a></h3>
<p>With this new tracker, we now have the ability to control the traversal depth for upstream
dependencies and downstream dependents in <code>moon query projects</code>, via the <code>--upstream</code> and
<code>--downstream</code> options respectively (the <code>--dependents</code> option is now deprecated).</p>
<p>These options support the following values:</p>
<ul>
<li><code>none</code> - Do not traverse deps.</li>
<li><code>direct</code> - Traverse direct parent/child deps.</li>
<li><code>deep</code> - Traverse full hierarchy deps.</li>
</ul>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon query projects </span><span class="token parameter variable" style="color:#fef9c3">--affected</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--upstream</span><span class="token plain"> none </span><span class="token parameter variable" style="color:#fef9c3">--downstream</span><span class="token plain"> deep</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="what-about-tasks">What about tasks?<a href="https://moonrepo.dev/blog/moon-v1.29#what-about-tasks" class="hash-link" aria-label="Direct link to What about tasks?" title="Direct link to What about tasks?">​</a></h3>
<p>We have the existing affected logic that has powered moon for years, and have updated that to
include the new logging. However, it's not perfect and we want to improve it.</p>
<p>To support this overall enhancement for tasks, we need to support a task graph, which we currently
do not. We only have a project graph (which has tasks), and an action graph (which has more than
tasks). In a future release, we'll introduce a new task graph that will fill the gaps.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="experimental-support-for-pkl-based-configuration">Experimental support for Pkl based configuration<a href="https://moonrepo.dev/blog/moon-v1.29#experimental-support-for-pkl-based-configuration" class="hash-link" aria-label="Direct link to Experimental support for Pkl based configuration" title="Direct link to Experimental support for Pkl based configuration">​</a></h2>
<p>Pkl, what is that? If you haven't heard of Pkl yet,
<a href="https://pkl-lang.org/" target="_blank" rel="noopener noreferrer">Pkl is a programmable configuration format by Apple</a>. But what about YAML?
YAML has served us well since the beginning, but we're not happy with YAML. It's better than JSON,
TOML, and XML, but still has its downsides. We want something better, something that meets the
following requirements:</p>
<ul>
<li>Is easy to read and write.</li>
<li>Is dynamic and programmable (loops, variables, etc).</li>
<li>Has type-safety or built-in schema support.</li>
<li>Has Rust serde integration.</li>
</ul>
<p>The primary requirement that we are hoping to achieve is adopting a configuration format that is
<em>programmable</em>. We want something that has native support for variables, loops, conditions, and
more, so that you could curate and compose your configuration very easily. Hacking this
functionality into YAML is a terrible user experience in our opinion!</p>
<p>And with all that said, I'm sure you're curious what Pkl actually looks like in practice. Here's a
few examples (unfortunately no syntax highlighting)!</p>
<div class="tabs-container tabList_J5MA"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_l0OV tabs__item--active">moon.pkl</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_l0OV">.moon/workspace.pkl</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_l0OV">.moon/toolchain.pkl</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_wHwb"><div class="language-pkl codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-pkl codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">type = "application"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">language = "typescript"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">dependsOn = List("client", "ui")</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">tasks {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  ["build"] {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    command = "docusaurus build"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    deps = List("^:build")</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    outputs = List("build")</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    options {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      interactive = true</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      retryCount = 3</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  ["typecheck"] {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    command = "tsc --build"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    inputs = new Listing {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      "@globs(sources)"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      "@globs(tests)"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      "tsconfig.json"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      "/tsconfig.options.json"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">}</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_wHwb" hidden=""><div class="language-pkl codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-pkl codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">projects {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  globs = List("apps/*", "packages/*")</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  sources {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    ["root"] = "."</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">}</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">vcs {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  defaultBranch = "master"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">}</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_wHwb" hidden=""><div class="language-pkl codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-pkl codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">node {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  version = "20.15.0"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  packageManager = "yarn"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  yarn {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    version = "4.3.1"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  addEnginesConstraint = false</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  inferTasksFromScripts = false</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">}</span><br></span></code></pre></div></div></div></div></div>
<p>Pretty straight forward for the most part! Lists/Listings (arrays) are a bit different than what you
may be used to, but they're super easy to learn.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="advanced-examples">Advanced examples<a href="https://moonrepo.dev/blog/moon-v1.29#advanced-examples" class="hash-link" aria-label="Direct link to Advanced examples" title="Direct link to Advanced examples">​</a></h3>
<p>I've talked a lot about programmable configs, but what exactly does that look like? Let's go through
a few examples. Say you are building a Rust crate and you need a build task for each operating
system. In YAML you would need to define each of these manually, but with Pkl, you can build it with
a loop!</p>
<div class="language-pkl codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-pkl codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">tasks {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  for (_os in List("linux", "macos", "windows")) {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    ["build-\(_os)"] {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      command = "cargo"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      args = List(</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">        "--target",</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">        if (_os == "linux") "x86_64-unknown-linux-gnu"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">          else if (_os == "macos") "x86_64-apple-darwin"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">          else "i686-pc-windows-msvc",</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">        "--verbose"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      options {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">        os = _os</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Or maybe you want to share inputs across multiple tasks. This can be achieved with <code>local</code>
variables.</p>
<div class="language-pkl codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-pkl codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">local _sharedInputs = List("src/**/*")</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">tasks {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  ["test"] {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    inputs = List("tests/**/*") + _sharedInputs</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  ["lint"] {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    inputs = List("**/*.graphql") + _sharedInputs</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Pretty awesome right? This is just a taste of what Pkl has to offer! We highly suggest reading the
<a href="https://pkl-lang.org/main/current/language-reference/index.html" target="_blank" rel="noopener noreferrer">language reference</a>, the
<a href="https://pkl-lang.org/main/current/standard-library.html" target="_blank" rel="noopener noreferrer">standard library</a>, or looking at our
<a href="https://github.com/moonrepo/moon/tree/master/crates/config/tests/__fixtures__/pkl" target="_blank" rel="noopener noreferrer">example configurations</a>
while testing Pkl.</p>
<blockquote>
<p>In the future, if Pkl seems like the right fit, we plan to take full advantage of what it has to
offer, by creating our own Pkl projects, modules, and types!</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="caveats-and-restrictions">Caveats and restrictions<a href="https://moonrepo.dev/blog/moon-v1.29#caveats-and-restrictions" class="hash-link" aria-label="Direct link to Caveats and restrictions" title="Direct link to Caveats and restrictions">​</a></h3>
<p>Since this is an entirely new configuration format that is quite dynamic compared to YAML, there are
some key differences to be aware of!</p>
<ul>
<li>
<p>Each <code>.pkl</code> file is evaluated in isolation (loops are processed, variables assigned, etc). This
means that task inheritance and file merging cannot extend or infer this native functionality.</p>
</li>
<li>
<p><code>default</code> is a
<a href="https://pkl-lang.org/main/current/language-reference/index.html#default-element" target="_blank" rel="noopener noreferrer">special feature</a>
in Pkl and cannot be used as a setting name. This only applies to
<a href="https://moonrepo.dev/docs/config/template#default"><code>template.yml</code></a>, but can be worked around by using <code>defaultValue</code>
instead.</p>
</li>
</ul>
<div class="language-pkl codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">template.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-pkl codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">variables {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  ["age"] {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    type = "number"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    prompt = "Age?"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    defaultValue = 0</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">}</span><br></span></code></pre></div></div>
<ul>
<li><code>local</code> is also a reserved word in Pkl. It can be worked around by escaping it with backticks, or
you can simply use the <a href="https://moonrepo.dev/docs/config/project#preset"><code>preset</code> setting</a> instead.</li>
</ul>
<div class="language-pkl codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-pkl codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">tasks {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  ["example"] {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    `local` = true</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    # Or</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    preset = "server"</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">}</span><br></span></code></pre></div></div>
<ul>
<li>Only files are supported. Cannot use or extend from URLs.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="how-to-use-pkl">How to use Pkl?<a href="https://moonrepo.dev/blog/moon-v1.29#how-to-use-pkl" class="hash-link" aria-label="Direct link to How to use Pkl?" title="Direct link to How to use Pkl?">​</a></h3>
<p>As mentioned in the heading, Pkl support is experimental, and <em>is not</em> enabled by default. If you're
interested in trying out Pkl, you can with the following:</p>
<ul>
<li><a href="https://pkl-lang.org/main/current/pkl-cli/index.html#installation" target="_blank" rel="noopener noreferrer">Install <code>pkl</code> onto <code>PATH</code></a>.
Pkl uses a client-server communication model.<!-- -->
<ul>
<li>Can also be installed with proto:
<code>proto plugin add pkl https://raw.githubusercontent.com/milesj/proto-plugins/refs/heads/master/pkl.toml</code></li>
</ul>
</li>
<li>Use the <code>.pkl</code> file extension instead of <code>.yml</code>.</li>
<li>Pass the <code>--experimentPklConfig</code> CLI option, or set the <code>MOON_EXPERIMENT_PKL_CONFIG</code> environment
variable.</li>
</ul>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon check </span><span class="token parameter variable" style="color:#fef9c3">--all</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--experimentPklConfig</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ </span><span class="token assign-left variable" style="color:#fef9c3">MOON_EXPERIMENT_PKL_CONFIG</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token plain">true moon check </span><span class="token parameter variable" style="color:#fef9c3">--all</span><br></span></code></pre></div></div>
<blockquote>
<p>Pkl can be used alongside YAML with no issues! We'll merge, inherit, and compose as usual.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="what-about-x-instead">What about X instead?<a href="https://moonrepo.dev/blog/moon-v1.29#what-about-x-instead" class="hash-link" aria-label="Direct link to What about X instead?" title="Direct link to What about X instead?">​</a></h3>
<p>There are a handful of other interesting or popular programmable configurations out there, so why
isn't moon experimenting with those? The answer is, we may! Just so long as they meet the
requirements. With that said, we do have some opinions below:</p>
<ul>
<li><a href="https://github.com/bazelbuild/starlark/" target="_blank" rel="noopener noreferrer">Starlark/Skylark</a> - On our list to evaluate.</li>
<li><a href="https://nickel-lang.org/" target="_blank" rel="noopener noreferrer">Nickel</a>, <a href="https://jsonnet.org/" target="_blank" rel="noopener noreferrer">Jsonnet</a> - On our list to evaluate, but
not a fan of the JSON-like syntax.</li>
<li><a href="https://dhall-lang.org/" target="_blank" rel="noopener noreferrer">Dhall</a> - While this meets most of our requirements, the syntax isn't as
readable or user-friendly as we'd like.</li>
<li><a href="https://cuelang.org/" target="_blank" rel="noopener noreferrer">CUE</a> - No Rust support, so unlikely. It also works quite differently than
the other tools.</li>
<li><a href="https://www.kcl-lang.io/" target="_blank" rel="noopener noreferrer">KCL</a> - Nice syntax and meets the requirements, but no Rust support.</li>
</ul>
<p>If there's another format you think we should investigate, drop us a line in Discord!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="looking-for-contributors">Looking for contributors!<a href="https://moonrepo.dev/blog/moon-v1.29#looking-for-contributors" class="hash-link" aria-label="Direct link to Looking for contributors!" title="Direct link to Looking for contributors!">​</a></h2>
<p>Are you a fan of moon (or proto)? Interested in learning Rust or writing more Rust? Want to
contribute to an awesome project (we think so)? Well it just so happens that we are looking for
active contributors!</p>
<p>We have a very long roadmap of features we would like to implement, but do not have enough time or
resources to implement them in the timeframe we would like. These features range from very small
(low hanging fruit) to very large (and quite complex).</p>
<p>If this sounds like something you may be interested in, post a message in Discord and let us know!
Only a few hours a week commitment is good enough for us.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.29#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.29.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added a new task option, <code>cacheLifetime</code>, that controls how long a task will be cached for.</li>
<li>Added a new task merge strategy, <code>preserve</code>, that preserves the original inherited value.</li>
<li>Added a new setting <code>vcs.hookFormat</code> to <code>.moon/workspace.yml</code>, that can customize the shell/file
format for hooks.</li>
<li>Updated task <code>outputs</code> to support token and environment variables.</li>
<li>Updated <code>moon query projects</code> to include the project description as a trailing value.</li>
<li>Updated <code>moon query tasks</code> to include the task type and platform, and the task description as a
trailing value.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="affected" term="affected"/>
        <category label="detection" term="detection"/>
        <category label="tracker" term="tracker"/>
        <category label="project" term="project"/>
        <category label="task" term="task"/>
        <category label="config" term="config"/>
        <category label="pkl" term="pkl"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.28 - Task presets, OS tasks, meta tokens, and more]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.28</id>
        <link href="https://moonrepo.dev/blog/moon-v1.28"/>
        <updated>2024-09-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we've focused on developer experience and quality-of-life improvements.]]></summary>
        <content type="html"><![CDATA[<p>In this release, we've focused on developer experience and quality-of-life improvements.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-task-presets">New task presets<a href="https://moonrepo.dev/blog/moon-v1.28#new-task-presets" class="hash-link" aria-label="Direct link to New task presets" title="Direct link to New task presets">​</a></h2>
<p>For the longest time, moon has supported the <a href="https://moonrepo.dev/docs/config/project#local"><code>local</code></a> setting for
tasks. This setting was added early on to reduce the amount of options configuration necessary for
tasks that "should only run locally". However, after years of supporting this setting, we've
discovered a few short-comings with it:</p>
<ul>
<li>The name is confusing. It's not apparent what "local" really means for newcomers.</li>
<li>This setting also changes non-local related options, like <code>persistent</code> and <code>cache</code>, which isn't
apparent to the user.</li>
<li>Setting the value to <code>false</code> doesn't inverse the options values. For example, enabling <code>runInCI</code>.</li>
</ul>
<p>At this point we thought to ourselves "how can we improve this experience?". Instead of reworking
<code>local</code>, we've opted to introduce a new task setting called <a href="https://moonrepo.dev/docs/config/project#preset"><code>preset</code></a>,
which configures a collection of task options, and deprecate the <code>local</code> setting. Presets are a much
better pattern, as it allows us to support multiple presets, and uniquely name our presets. For
example, old <code>local</code> tasks can be rewritten as such:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># Before</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">start</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite dev'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">local</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># After</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">start</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite dev'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">preset</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'server'</span><br></span></code></pre></div></div>
<p>To start, we're introducing 2 presets: <code>server</code> and <code>watcher</code>. Check out the
<a href="https://moonrepo.dev/docs/config/project#preset">documentation for more information</a> on what these presets configure!
If you have ideas for other presets, we would love to hear them.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-os-specific-tasks">New OS specific tasks<a href="https://moonrepo.dev/blog/moon-v1.28#new-os-specific-tasks" class="hash-link" aria-label="Direct link to New OS specific tasks" title="Direct link to New OS specific tasks">​</a></h2>
<p>When moon was originally designed, it was meant to be a very simple but easily configurable task
runner. But since then, moon has grown drastically, and so has the requirements of its users. One
such request was being able to define tasks that only run for certain operating systems.</p>
<p>This wasn't possible before; but is now thanks to the new
<a href="https://moonrepo.dev/docs/config/project#os"><code>os</code> task option</a>. This option can be configured with "linux", "macos", or
"windows" to target those specific systems, and can be a single value, or list of values.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build-linux</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'cargo build --target x86_64-unknown-linux-gnu'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">os</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'linux'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build-macos</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'cargo build --target x86_64-apple-darwin'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">os</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'macos'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build-windows</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'cargo build --target x86_64-pc-windows-msvc'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">os</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'windows'</span><br></span></code></pre></div></div>
<p>When a task is ran on a non-compatible system, it will be converted to a no-operation task, so that
dependency chains still resolve correctly.</p>
<blockquote>
<p>In the future, we will look into supporting system architecture as well.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-meta-token-function">New <code>@meta</code> token function<a href="https://moonrepo.dev/blog/moon-v1.28#new-meta-token-function" class="hash-link" aria-label="Direct link to new-meta-token-function" title="Direct link to new-meta-token-function">​</a></h2>
<p>In our last release, we introduced the <a href="https://moonrepo.dev/docs/config/project#metadata-1"><code>project.metadata</code></a> setting
as a means for consumers to define their own metadata. This is great but it provided no other
benefit, as it required consumers to open up config files to discover this metadata, or consumers to
write custom abstractions/tooling. We want to improve the integration of this information within
moon, so to start, we're introducing a new token function <a href="https://moonrepo.dev/docs/concepts/token#meta"><code>@meta(key)</code></a>.</p>
<p>The <a href="https://moonrepo.dev/docs/concepts/token#meta"><code>@meta(key)</code></a> token function can be used to access project metadata
from both the <a href="https://moonrepo.dev/docs/config/project#project"><code>project</code></a> and
<a href="https://moonrepo.dev/docs/config/project#metadata-1"><code>project.metadata</code></a> settings. The former values will be used
as-is, while the latter values will be JSON stringified (since consumers can define anything).</p>
<p>With this new token, our task composition has grown even deeper. For example, you can define a task
at the top-level that a project inherits, and then define metadata within that project for the task!
With that said, this is more of a stopgap solution until we support true variables within
configuration.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/tasks.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">script</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'compile --label @meta(name) --compress @meta(compression)'</span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">&lt;project&gt;/moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">project</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'example'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">compression</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">9</span><br></span></code></pre></div></div>
<p>And lastly, while we're on the topic of tokens, we're also introducing <code>$projectName</code>,
<code>$projectChannel</code>, and <code>$projectOwner</code> token variables, as an easier alternative solution.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-disallowrunincimismatch-experiment">New <code>disallowRunInCiMismatch</code> experiment<a href="https://moonrepo.dev/blog/moon-v1.28#new-disallowrunincimismatch-experiment" class="hash-link" aria-label="Direct link to new-disallowrunincimismatch-experiment" title="Direct link to new-disallowrunincimismatch-experiment">​</a></h2>
<p>Have you ever ran <a href="https://moonrepo.dev/docs/commands/ci"><code>moon ci</code></a> in CI and encountered a scenario where tasks that
<em>should</em> have run didn't run? Or the dependency of a task never runs causing the dependent to fail?
If so, this may apply to you!</p>
<p>This scenario is most likely caused by an invalid relationship where the dependent is
<a href="https://moonrepo.dev/docs/config/project#runinci"><code>runInCI</code></a> enabled, but the dependency is
<a href="https://moonrepo.dev/docs/config/project#runinci"><code>runInCI</code></a> disabled. For example:</p>
<div class="language-yml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">moon.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">runInCI</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">analyze</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">deps</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">'build'</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">runInCI</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre></div></div>
<p>Because <code>build</code> is disabled, its outputs may not be created. Additionally, if <code>build</code> is affected by
touched files, the <code>analyze</code> task will not run automatically unless it was also affected. We try our
best to accommodate these scenarios and "detect" when things should run or not, but it's fallible,
as there's many ways that tasks can relate to each other.</p>
<p>To try and remedy this going forward, we're introducing the new <code>disallowRunInCiMismatch</code> experiment
that will <em>hard error</em> if an invalid relationship is configured. We want to try and capture how
often users are configuring this, whether intentionally or accidentally. If the error becomes a
blocker, the experiment can be disabled as so:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_kY6l">.moon/workspace.yml</div><div class="codeBlockContent_t_Hd"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">experiments</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">disallowRunInCiMismatch</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.28#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.28.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>We've sunset the CI insights feature in moonbase. We will no longer be tracking CI run history.
This is a retroactive change that applies to all moon versions.</li>
<li>Added <code>codeowners.requiredApprovals</code> setting to <code>.moon/workspace.yml</code>, that will apply
requirements to all paths.</li>
<li>Updated the terminal checkpoint (4 squares) colors to better reflect their state.</li>
<li>Updated <code>MOON_TOOLCHAIN_FORCE_GLOBALS</code> to support filtering by tool IDs, instead of applying to
everything.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="os" term="os"/>
        <category label="task" term="task"/>
        <category label="meta" term="meta"/>
        <category label="token" term="token"/>
        <category label="toolchain" term="toolchain"/>
        <category label="preset" term="preset"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.40 - Config mode, progress bars, and more]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.40</id>
        <link href="https://moonrepo.dev/blog/proto-v0.40"/>
        <updated>2024-08-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[This is a small release that includes many quality of life improvements.]]></summary>
        <content type="html"><![CDATA[<p>This is a small release that includes many quality of life improvements.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new---config-mode-global-option">New <code>--config-mode</code> global option<a href="https://moonrepo.dev/blog/proto-v0.40#new---config-mode-global-option" class="hash-link" aria-label="Direct link to new---config-mode-global-option" title="Direct link to new---config-mode-global-option">​</a></h2>
<p>When proto is ran, we find and load all applicable <a href="https://moonrepo.dev/docs/proto/config"><code>.prototools</code> files</a>. For
the most part, we would traverse upwards, and sometimes load <code>~/.proto/.prototools</code>, while other
times not. It was quite confusing when certain config files were loaded. This was further
exacerbated by the <code>--include-global</code> and <code>--only-local</code> options, which were only available to some
commands (and have been removed entirely).</p>
<p>To remedy and standardize this, we're introducing a new global option
<a href="https://moonrepo.dev/docs/proto/config#resolution-mode"><code>--config-mode</code></a> (<code>-c</code>), which controls how configuration are
loaded. This option supports the following values.</p>
<ul>
<li><code>global</code> - Only load <code>~/.proto/.prototools</code>.</li>
<li><code>local</code> - Only load <code>./.prototools</code> in the current directory.</li>
<li><code>upwards</code> - Load <code>.prototools</code> while traversing upwards, but do not load <code>~/.proto/.prototools</code>.</li>
<li><code>upwards-global</code> / <code>all</code> - Load <code>.prototools</code> while traversing upwards, and do load
<code>~/.proto/.prototools</code>.</li>
</ul>
<p>Now what is the default mode? As mentioned above, we wanted to standardize the default across all
commands, but the problem is, is that each command has different requirements. So in the end, the
default mode is actually 2 different modes depending on the command being ran, which is:</p>
<ul>
<li>For <code>activate</code>, <code>install</code>, <code>outdated</code>, <code>status</code> commands -&gt; <code>upwards</code> mode</li>
<li>All other commands -&gt; <code>upwards-global</code> mode</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-progress-bars">Improved progress bars<a href="https://moonrepo.dev/blog/proto-v0.40#improved-progress-bars" class="hash-link" aria-label="Direct link to Improved progress bars" title="Direct link to Improved progress bars">​</a></h2>
<p>We've improved (or added) the progress bars for <a href="https://moonrepo.dev/docs/proto/commands/install"><code>proto install</code></a>,
<a href="https://moonrepo.dev/docs/proto/commands/upgrade"><code>proto upgrade</code></a>, and the auto-install flow for
<a href="https://moonrepo.dev/docs/proto/commands/run"><code>proto run</code></a>. The progress bars will now display the current phase
(download, unpack, etc), and the download phase will now include current / total downloaded bytes.</p>
<p>Furthermore, when installing multiple tools, we now display a progress bar for each tool.</p>
<div style="margin-bottom:1rem;margin-top:1rem;text-align:center"><img src="https://moonrepo.dev/assets/images/v0.40-progress-9b4c68fcd969d5312791dc1234379127.png" width="100%" alt="" class="inline-block"></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-http-requests">Improved HTTP requests<a href="https://moonrepo.dev/blog/proto-v0.40#improved-http-requests" class="hash-link" aria-label="Direct link to Improved HTTP requests" title="Direct link to Improved HTTP requests">​</a></h2>
<p>For historical context, requests made from the proto CLI itself use a different HTTP client than
requests made from a WASM plugin. The reason for this is that the Rust-based HTTP client that proto
uses is not compatible within WASM, so plugins use a different library. This disconnect meant that
WASM requests did <em>not</em> inherit the <a href="https://moonrepo.dev/docs/proto/config#settingshttp"><code>[settings.http]</code></a> settings,
which meant in some cases, requests would fail or not authenticate correctly, and there was no
work-around.</p>
<p>This is a very tricky problem to solve, but we have implemented a possible solution through a
concept known as <a href="https://moonrepo.dev/docs/guides/wasm-plugins#host-functions--macros">host functions</a>. Host functions
are basically functions that exist on the host machine (proto), and can be called from the guest
runtime (WASM). This new host function utilizes the same HTTP client as proto to make requests,
which results in WASM no longer being disconnected.</p>
<p>However, since there is a cost for calling host functions from the guest, and then serializing the
response from the host back to the guest, there is a small chance that performance will be affected.
We will continue to monitor the implementation, so please report any issues!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.40#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.40.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Removed <code>--include-global</code> and <code>--only-local</code> flags from all applicable commands. Use the new
<code>--config-mode</code> instead.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="config" term="config"/>
        <category label="mode" term="mode"/>
        <category label="progress" term="progress"/>
        <category label="install" term="install"/>
        <category label="http" term="http"/>
        <category label="request" term="request"/>
        <category label="fetch" term="fetch"/>
    </entry>
</feed>